%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
    case 'Problem4aS' % P R O B L E M   4 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%    RUTAS: MATRIZ DE CONFLICTOS Y TIEMPOS DE VIAJES 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
Mueve=@(A) [A(:,3) A(:,4) A(:,1) A(:,2)]; 
n_rutas=7 ;  
t_pla=[5.233 ; 5.417 ; 5.700 ; 5.900 ; 6.050 ; 6.250 ; 6.633 ; 6.883 ; 7.133 ; 7.350 ; 7.500 ; 7.850 ; 7.967 ; 8.350 ; 8.617 ; 8.850 ; 9.117 ; 9.350 ; 9.617 ; 9.850 ; 10.367 ; 10.850 ; 11.367 ; 11.850 ; 12.367 ; 12.817 ; 13.367 ; 13.850 ; 14.100 ; 14.367 ; 14.600 ; 14.850 ; 15.133 ; 15.350 ; 15.600 ; 15.850 ; 16.100 ; 16.350 ; 16.600 ; 16.850 ; 17.100 ; 17.350 ; 17.617 ; 17.850 ; 18.100 ; 18.350 ; 18.600 ; 18.850 ; 19.100 ; 19.350 ; 19.633 ; 19.850 ; 20.100 ; 20.350 ; 20.867 ; 21.367 ; 21.850 ; 22.367 ; 22.850 ; 23.350 ; 23.850 ; 5.217 ; 6.500 ; 6.717 ; 7.000 ; 7.700 ; 8.017 ; 8.233 ; 8.467 ; 8.733 ; 8.967 ; 9.200 ; 9.467 ; 9.700 ; 9.983 ; 10.200 ; 10.667 ; 11.183 ; 11.683 ; 12.183 ; 12.683 ; 13.183 ; 13.683 ; 13.967 ; 14.183 ; 14.483 ; 14.700 ; 14.967 ; 15.200 ; 15.483 ; 15.650 ; 16.217 ; 16.700 ; 17.200 ; 17.700 ; 18.200 ; 18.483 ; 18.700 ; 18.983 ; 19.200 ; 19.467 ; 19.683 ; 19.967 ; 20.200 ; 20.700 ; 21.200 ; 21.700 ; 22.200 ; 22.700 ; 23.200 ; 23.700 ; 5.983 ; 6.267 ; 6.517 ; 6.750 ; 6.983 ; 7.167 ; 7.367 ; 7.567 ; 7.750 ; 7.967 ; 8.117 ; 8.367 ; 8.533 ; 8.700 ; 8.967 ; 9.167 ; 9.367 ; 9.550 ; 9.750 ; 10.000 ; 10.267 ; 10.517 ; 10.983 ; 11.500 ; 11.983 ; 12.517 ; 12.983 ; 13.517 ; 13.983 ; 14.267 ; 14.500 ; 14.767 ; 14.983 ; 15.267 ; 15.500 ; 15.767 ; 15.983 ; 16.250 ; 16.517 ; 16.750 ; 16.983 ; 17.517 ; 17.750 ; 17.983 ; 18.267 ; 18.483 ; 18.750 ; 19.000 ; 19.250 ; 19.483 ; 19.750 ; 19.983 ; 20.250 ; 20.517 ; 20.750 ; 20.983 ; 21.267 ; 21.533 ; 22.017 ; 22.517 ; 22.983 ; 23.517 ; 0.050 ; 6.433 ; 6.650 ; 6.933 ; 7.633 ; 7.950 ; 8.167 ; 8.400 ; 8.667 ; 8.900 ; 9.133 ; 9.400 ; 9.633 ; 9.917 ; 10.133 ; 10.600 ; 11.117 ; 11.617 ; 12.117 ; 12.617 ; 13.117 ; 13.617 ; 13.900 ; 14.117 ; 14.417 ; 14.633 ; 14.900 ; 15.133 ; 15.417 ; 15.583 ; 16.150 ; 16.633 ; 17.133 ; 17.633 ; 18.133 ; 18.417 ; 18.633 ; 18.917 ; 19.133 ; 19.400 ; 19.617 ; 19.900 ; 20.133 ; 20.633 ; 21.133 ; 21.633 ; 22.133 ; 22.633 ; 23.133 ; 23.633 ; ]; 
at=[5.321 ; 5.504 ; 5.788 ; 5.988 ; 6.138 ; 6.338 ; 6.721 ; 6.971 ; 7.221 ; 7.438 ; 7.588 ; 7.938 ; 8.054 ; 8.438 ; 8.704 ; 8.938 ; 9.204 ; 9.438 ; 9.704 ; 9.938 ; 10.454 ; 10.938 ; 11.454 ; 11.938 ; 12.454 ; 12.904 ; 13.454 ; 13.938 ; 14.188 ; 14.454 ; 14.688 ; 14.938 ; 15.221 ; 15.438 ; 15.688 ; 15.938 ; 16.187 ; 16.438 ; 16.687 ; 16.938 ; 17.187 ; 17.438 ; 17.704 ; 17.938 ; 18.187 ; 18.438 ; 18.687 ; 18.938 ; 19.187 ; 19.438 ; 19.721 ; 19.938 ; 20.187 ; 20.438 ; 20.954 ; 21.454 ; 21.938 ; 22.454 ; 22.938 ; 23.438 ; 23.938 ; 5.304 ; 6.588 ; 6.804 ; 7.088 ; 7.788 ; 8.104 ; 8.321 ; 8.554 ; 8.821 ; 9.054 ; 9.287 ; 9.554 ; 9.787 ; 10.071 ; 10.287 ; 10.754 ; 11.271 ; 11.771 ; 12.271 ; 12.771 ; 13.271 ; 13.771 ; 14.054 ; 14.271 ; 14.571 ; 14.787 ; 15.054 ; 15.287 ; 15.571 ; 15.738 ; 16.304 ; 16.788 ; 17.288 ; 17.788 ; 18.288 ; 18.571 ; 18.788 ; 19.071 ; 19.288 ; 19.554 ; 19.771 ; 20.054 ; 20.288 ; 20.788 ; 21.288 ; 21.788 ; 22.288 ; 22.788 ; 23.288 ; 23.788 ; 6.071 ; 6.354 ; 6.604 ; 6.838 ; 7.071 ; 7.254 ; 7.454 ; 7.654 ; 7.838 ; 8.054 ; 8.204 ; 8.454 ; 8.621 ; 8.787 ; 9.054 ; 9.254 ; 9.454 ; 9.638 ; 9.837 ; 10.088 ; 10.354 ; 10.604 ; 11.071 ; 11.588 ; 12.071 ; 12.604 ; 13.071 ; 13.604 ; 14.071 ; 14.354 ; 14.588 ; 14.854 ; 15.071 ; 15.354 ; 15.588 ; 15.854 ; 16.071 ; 16.337 ; 16.604 ; 16.837 ; 17.071 ; 17.604 ; 17.837 ; 18.071 ; 18.354 ; 18.571 ; 18.837 ; 19.087 ; 19.337 ; 19.571 ; 19.837 ; 20.071 ; 20.337 ; 20.604 ; 20.837 ; 21.071 ; 21.354 ; 21.621 ; 22.104 ; 22.604 ; 23.071 ; 23.604 ; 0.138 ; 6.521 ; 6.737 ; 7.021 ; 7.721 ; 8.037 ; 8.254 ; 8.488 ; 8.754 ; 8.987 ; 9.221 ; 9.488 ; 9.721 ; 10.004 ; 10.221 ; 10.688 ; 11.204 ; 11.704 ; 12.204 ; 12.704 ; 13.204 ; 13.704 ; 13.987 ; 14.204 ; 14.504 ; 14.721 ; 14.987 ; 15.221 ; 15.504 ; 15.671 ; 16.237 ; 16.721 ; 17.221 ; 17.721 ; 18.221 ; 18.504 ; 18.721 ; 19.004 ; 19.221 ; 19.487 ; 19.704 ; 19.987 ; 20.221 ; 20.721 ; 21.221 ; 21.721 ; 22.221 ; 22.721 ; 23.221 ; 23.721 ; ]; 
vt=[40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; ]; 
n_t=length(t_pla);  % n√∫mero de trenes 
Ntipotren=[1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; ]; 
tipotren={'C2+','','C2-','','C7+','','C7-','','C5+','','C5-','','C4+','','C4-','','C3+','','C3-'}; 
C{1,1}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
]; 
C{1,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,3}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{3,4}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,5}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,6}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,7}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{4,4}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{4,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,6}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{7,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{1,1}=Mueve(C{1,1}); 
C{2,1}=Mueve(C{1,2}); 
C{3,1}=Mueve(C{1,3}); 
C{4,1}=Mueve(C{1,4}); 
C{5,1}=Mueve(C{1,5}); 
C{6,1}=Mueve(C{1,6}); 
C{7,1}=Mueve(C{1,7}); 
C{2,2}=Mueve(C{2,2}); 
C{3,2}=Mueve(C{2,3}); 
C{4,2}=Mueve(C{2,4}); 
C{5,2}=Mueve(C{2,5}); 
C{6,2}=Mueve(C{2,6}); 
C{7,2}=Mueve(C{2,7}); 
C{3,3}=Mueve(C{3,3}); 
C{4,3}=Mueve(C{3,4}); 
C{5,3}=Mueve(C{3,5}); 
C{6,3}=Mueve(C{3,6}); 
C{7,3}=Mueve(C{3,7}); 
C{4,4}=Mueve(C{4,4}); 
C{5,4}=Mueve(C{4,5}); 
C{6,4}=Mueve(C{4,6}); 
C{7,4}=Mueve(C{4,7}); 
C{5,5}=Mueve(C{5,5}); 
C{6,5}=Mueve(C{5,6}); 
C{7,5}=Mueve(C{5,7}); 
C{6,6}=Mueve(C{6,6}); 
C{7,6}=Mueve(C{6,7}); 
C{7,7}=Mueve(C{7,7}); 
Marcha=zeros(n_t,n_rutas); 
Marcha(1:111,[1,2,3])=+1; 
Marcha(112:223,[4,5,6,7])=-1; 
TVr=[3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%  asignacion rutas a trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
R{1}=[3]; 
R{2}=[3]; 
R{3}=[3]; 
R{4}=[3]; 
R{5}=[3]; 
R{6}=[3]; 
R{7}=[3]; 
R{8}=[3]; 
R{9}=[3]; 
R{10}=[3]; 
R{11}=[3]; 
R{12}=[3]; 
R{13}=[3]; 
R{14}=[3]; 
R{15}=[3]; 
R{16}=[3]; 
R{17}=[3]; 
R{18}=[3]; 
R{19}=[3]; 
R{20}=[3]; 
R{21}=[3]; 
R{22}=[3]; 
R{23}=[3]; 
R{24}=[3]; 
R{25}=[3]; 
R{26}=[3]; 
R{27}=[3]; 
R{28}=[3]; 
R{29}=[3]; 
R{30}=[3]; 
R{31}=[3]; 
R{32}=[3]; 
R{33}=[3]; 
R{34}=[3]; 
R{35}=[3]; 
R{36}=[3]; 
R{37}=[3]; 
R{38}=[3]; 
R{39}=[3]; 
R{40}=[3]; 
R{41}=[3]; 
R{42}=[3]; 
R{43}=[3]; 
R{44}=[3]; 
R{45}=[3]; 
R{46}=[3]; 
R{47}=[3]; 
R{48}=[3]; 
R{49}=[3]; 
R{50}=[3]; 
R{51}=[3]; 
R{52}=[3]; 
R{53}=[3]; 
R{54}=[3]; 
R{55}=[3]; 
R{56}=[3]; 
R{57}=[3]; 
R{58}=[3]; 
R{59}=[3]; 
R{60}=[3]; 
R{61}=[3]; 
R{62}=[1,2]; 
R{63}=[1,2]; 
R{64}=[1,2]; 
R{65}=[1,2]; 
R{66}=[1,2]; 
R{67}=[1,2]; 
R{68}=[1,2]; 
R{69}=[1,2]; 
R{70}=[1,2]; 
R{71}=[1,2]; 
R{72}=[1,2]; 
R{73}=[1,2]; 
R{74}=[1,2]; 
R{75}=[1,2]; 
R{76}=[1,2]; 
R{77}=[1,2]; 
R{78}=[1,2]; 
R{79}=[1,2]; 
R{80}=[1,2]; 
R{81}=[1,2]; 
R{82}=[1,2]; 
R{83}=[1,2]; 
R{84}=[1,2]; 
R{85}=[1,2]; 
R{86}=[1,2]; 
R{87}=[1,2]; 
R{88}=[1,2]; 
R{89}=[1,2]; 
R{90}=[1,2]; 
R{91}=[1,2]; 
R{92}=[1,2]; 
R{93}=[1,2]; 
R{94}=[1,2]; 
R{95}=[1,2]; 
R{96}=[1,2]; 
R{97}=[1,2]; 
R{98}=[1,2]; 
R{99}=[1,2]; 
R{100}=[1,2]; 
R{101}=[1,2]; 
R{102}=[1,2]; 
R{103}=[1,2]; 
R{104}=[1,2]; 
R{105}=[1,2]; 
R{106}=[1,2]; 
R{107}=[1,2]; 
R{108}=[1,2]; 
R{109}=[1,2]; 
R{110}=[1,2]; 
R{111}=[1,2]; 
R{112}=[6,7]; 
R{113}=[6,7]; 
R{114}=[6,7]; 
R{115}=[6,7]; 
R{116}=[6,7]; 
R{117}=[6,7]; 
R{118}=[6,7]; 
R{119}=[6,7]; 
R{120}=[6,7]; 
R{121}=[6,7]; 
R{122}=[6,7]; 
R{123}=[6,7]; 
R{124}=[6,7]; 
R{125}=[6,7]; 
R{126}=[6,7]; 
R{127}=[6,7]; 
R{128}=[6,7]; 
R{129}=[6,7]; 
R{130}=[6,7]; 
R{131}=[6,7]; 
R{132}=[6,7]; 
R{133}=[6,7]; 
R{134}=[6,7]; 
R{135}=[6,7]; 
R{136}=[6,7]; 
R{137}=[6,7]; 
R{138}=[6,7]; 
R{139}=[6,7]; 
R{140}=[6,7]; 
R{141}=[6,7]; 
R{142}=[6,7]; 
R{143}=[6,7]; 
R{144}=[6,7]; 
R{145}=[6,7]; 
R{146}=[6,7]; 
R{147}=[6,7]; 
R{148}=[6,7]; 
R{149}=[6,7]; 
R{150}=[6,7]; 
R{151}=[6,7]; 
R{152}=[6,7]; 
R{153}=[6,7]; 
R{154}=[6,7]; 
R{155}=[6,7]; 
R{156}=[6,7]; 
R{157}=[6,7]; 
R{158}=[6,7]; 
R{159}=[6,7]; 
R{160}=[6,7]; 
R{161}=[6,7]; 
R{162}=[6,7]; 
R{163}=[6,7]; 
R{164}=[6,7]; 
R{165}=[6,7]; 
R{166}=[6,7]; 
R{167}=[6,7]; 
R{168}=[6,7]; 
R{169}=[6,7]; 
R{170}=[6,7]; 
R{171}=[6,7]; 
R{172}=[6,7]; 
R{173}=[6,7]; 
R{174}=[6,7]; 
R{175}=[4,5]; 
R{176}=[4,5]; 
R{177}=[4,5]; 
R{178}=[4,5]; 
R{179}=[4,5]; 
R{180}=[4,5]; 
R{181}=[4,5]; 
R{182}=[4,5]; 
R{183}=[4,5]; 
R{184}=[4,5]; 
R{185}=[4,5]; 
R{186}=[4,5]; 
R{187}=[4,5]; 
R{188}=[4,5]; 
R{189}=[4,5]; 
R{190}=[4,5]; 
R{191}=[4,5]; 
R{192}=[4,5]; 
R{193}=[4,5]; 
R{194}=[4,5]; 
R{195}=[4,5]; 
R{196}=[4,5]; 
R{197}=[4,5]; 
R{198}=[4,5]; 
R{199}=[4,5]; 
R{200}=[4,5]; 
R{201}=[4,5]; 
R{202}=[4,5]; 
R{203}=[4,5]; 
R{204}=[4,5]; 
R{205}=[4,5]; 
R{206}=[4,5]; 
R{207}=[4,5]; 
R{208}=[4,5]; 
R{209}=[4,5]; 
R{210}=[4,5]; 
R{211}=[4,5]; 
R{212}=[4,5]; 
R{213}=[4,5]; 
R{214}=[4,5]; 
R{215}=[4,5]; 
R{216}=[4,5]; 
R{217}=[4,5]; 
R{218}=[4,5]; 
R{219}=[4,5]; 
R{220}=[4,5]; 
R{221}=[4,5]; 
R{222}=[4,5]; 
R{223}=[4,5]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%% ordenacion procesamiento de trenes            %%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
[t_pla,I]=sort(t_pla); % ordenacion de procesamiento de trenes 
at=at(I); 
vt=vt.^(-1); 
vt=vt(I); 
Ntipotren=Ntipotren(I); 
Raux=R; 
Marcha=Marcha(I,:); 
for i=1:n_t 
   R{i}=Raux{I(i)}; 
end 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 %%%                 tiempo de viaje trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 for t1=1:n_t 
     for i_r=1:length(R{t1}) 
         D_t(t1,i_r)=TVr(R{t1}(i_r))*vt(t1)-at(t1); 
     end 
 end 
 n_s=0; % numero m√°ximo de conflicto entre un par de trenes 
for t1=1:n_t-1 
    for t2=t1+1:n_t 
        for i_r1=1:length(R{t1}) 
            r1=R{t1}(i_r1); 
            for i_r2=1:length(R{t2}) 
                r2=R{t2}(i_r2); 
                if length(C{r1,r2})>0 
                C_t{i_r1,i_r2,t1,t2}=[C{r1,r2}(:,1:2)*vt(t1) C{r1,r2}(:,3:4)*vt(t2)]; 
                C_t{i_r2,i_r1,t2,t1}=[C{r2,r1}(:,1:2)*vt(t2) C{r2,r1}(:,3:4)*vt(t1)]; 
                n_s=max(n_s,size(C_t{i_r1,i_r2,t1,t2},1)); 
                end 
            end 
        end 
    end 
end 
