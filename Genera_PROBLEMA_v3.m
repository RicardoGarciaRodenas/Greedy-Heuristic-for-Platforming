function Genera_PROBLEMA_v3(file_directory,file_name,version,id)
initia='orden'; % esto es una ñapa para no deshacer la posibilidad de generar orden aleatorios
% file_name
switch file_name
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    case 'Problem1' % P R O B L E M   1
        switch version
            case 'a'
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%              TIEMPOS PLANIFICADOS DE SALIDA/LLEGADA
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                t_pla=[3;0;5;2;5;6;7;8];        % departure time planeado
                %t_pla=[0;0;0;0;0;0;0;0];       % departure time planeado
                % esta solucion viene bien para testar conflictos en misma direccion
                at= [4;6;11;8;11;11;12;13];     % desired arrive time
                vt= [1;1;1;1;1;1;1;1];          % velocidad del tren para calacular tiempos de viajes
                % referencia 100km/h -> 1 200Km/h->2
        end
n_t=length(t_pla);  % número de trenes

% cambio
Ntipotren=ones(n_t);
tipotren={'tren'};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%    RUTAS: MATRIZ DE CONFLICTOS Y TIEMPOS DE VIAJES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
n_rutas=3;
C{1,2}=[1 2 4 5;     % conflicto 1 , LOS DOS PRIMEROS PRIMERA RUTA
        4 5 1 2];    % conflicto 2   LOS DOS SEGUNDOS SEGUNDA RUTA
C{3,2}=[0 2 4 6;
        3 4 3 3];
C{2,1}=[4 5 1 2;     % conflicto 1 , LOS DOS PRIMEROS numeros para PRIMERA RUTA
        1 2 4 5];    % conflicto 2   LOS DOS SEGUNDOS numeros para SEGUNDA RUTA
C{2,3}=[4 6 0 2;     % cada fila un conflicto
        3 3 3 4];
% conflictos por alcance     
C{1,1}=[0,6,0,6];
C{2,2}=[0,6,0,6];
C{3,3}=[0,6,0,6];
C{1,3}=[1,2,1,2];
C{3,1}=[1,2,1,2];
    
Marcha=zeros(n_t,n_rutas);  % tipo conflicto:  1= frontal /  2 =alcance
Marcha([1,3,7,8],[1,3])=+1; % tren y ruta (absoluta), hacia la derecha
Marcha([2,4,5,6],[2])=-1;   % hacia la izquierda
TVr=[6;6;6];                % tiempo de viaje rutas a 100 km/hora
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%  asignacion rutas a trenes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 R{1}=[1,3]; % rutas para el tren 1
 R{2}=[2];
 R{3}=[1,3];
 R{4}=[2];   
 R{5}=[2]; 
 R{6}=[2];
 R{7}=[1,3];
 R{8}=[1 3];   
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%% ordenacion procesamiento de trenes            %%%%%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 [t_pla,I]=InitOrden(initia,t_pla,n_t); % inicializacion del orden del procesamiento
at=at(I);
vt=vt.^(-1);
vt=vt(I);
Raux=R;
Marcha=Marcha(I,:);
for i=1:n_t
    R{i}=Raux{I(i)};
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%                 tiempo de viaje trenes
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 for t1=1:n_t
     for i_r=1:length(R{t1})
         D_t(t1,i_r)=TVr(R{t1}(i_r))*vt(t1)-at(t1);
     end
 end
 n_s=0; % numero máximo de conflicto entre un par de trenes
for t1=1:n_t-1
    for t2=t1+1:n_t
        for i_r1=1:length(R{t1})
            r1=R{t1}(i_r1);
            for i_r2=1:length(R{t2})
                r2=R{t2}(i_r2);
                if length(C{r1,r2})>0
                C_t{i_r1,i_r2,t1,t2}=[C{r1,r2}(:,1:2)*vt(t1) C{r1,r2}(:,3:4)*vt(t2)];
                C_t{i_r2,i_r1,t2,t1}=[C{r2,r1}(:,1:2)*vt(t2) C{r2,r1}(:,3:4)*vt(t1)];
                n_s=max(n_s,size(C_t{i_r1,i_r2,t1,t2},1));
                end
            end
        end
    end
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    case 'Problem2' % P R O B L E M   2
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        switch version
            case 'a'
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%              TIEMPOS PLANIFICADOS DE SALIDA/LLEGADA
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                t_pla=[5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24];        % departure time planeado
                %t_pla=[0;0;0;0;0;0;0;0];       % departure time planeado
                % esta solucion viene bien para testar conflictos en misma direccion
                at= [6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24;25;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24;25];;     % desired arrive time
                %vt= [300;300;300;300;300;300;300;300]*0.25;          % velocidad del tren para calacular tiempos de viajes
                vt=ones(40,1)*175+unidrnd(5,40,1)*25;
                % referencia 100km/h -> 1 200Km/h->2
            case 'b'
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%              TIEMPOS PLANIFICADOS DE SALIDA/LLEGADA
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                t_pla=rand(40,1)*20 +5;        % departure time planeado
                %t_pla=[0;0;0;0;0;0;0;0];       % departure time planeado
                % esta solucion viene bien para testar conflictos en misma direccion
                at= t_pla+1;     % desired arrive time
                %vt= [300;300;300;300;300;300;300;300]*0.25;          % velocidad del tren para calacular tiempos de viajes
                vt=ones(40,1)*250;
                % referencia 100km/h -> 1 200Km/h->2
        end
        n_t=length(t_pla);  % número de trenes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%    RUTAS: MATRIZ DE CONFLICTOS Y TIEMPOS DE VIAJES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
n_rutas=8;
Mueve=@(A) [A(:,3) A(:,4) A(:,1) A(:,2)];
C{1,5}=[ 0        228.3     0        228.3];
C{5,1}=Mueve(C{1,5});
C{1,6}=[ 0         33.3   208.2      241.5;
        91.2      228.3     0        137.1];
C{6,1}=Mueve(C{1,6});
C{1,7}=[ 0         33.3   222.3      255.6;
        91.2      105.0   137.4      151.2;
       179.4      228.3     0         48.9];
C{7,1}=Mueve(C{1,7});
C{1,8}=[ 0        105.0   123.3       242.4;
       179.4      228.3     0          48.9];
C{8,1}=Mueve(C{1,8});
C{2,5}=[ 0         33.3   195        228.3;
       104.4      241.5     0        137.1];
C{5,2}=Mueve(C{2,5});
C{2,6}=[   0        241.5       0        241.5];
C{6,2}=Mueve(C{2,6});
C{2,7}=[   0        118.2   137.4      255.6;
         192.6      241.5       0         48.9];
C{7,2}=Mueve(C{2,7});   
C{2,8}=[   0         33.3   209.1      242.4;
         104.4      118.2   137.4      151.2;
         192.6      241.5       0        48.9];
C{8,2}=Mueve(C{2,8});
C{3,5}=[    0        33.3 195.0      228.3;
        104.4      118.2  123.3      137.1;
        206.7      255.6    0         48.9];
C{5,3}=Mueve(C{3,5});
C{3,6}=[     0      118.2 123.3      241.5;
        206.7      255.6    0         48.9];
C{6,3}=Mueve(C{3,6});
C{3,7}=[     0      255.6   0        255.6];
C{7,3}=Mueve(C{3,7});
C{3,8}=[     0       33.3 209.1      242.4;
         104.4      255.6   0        151.2];
C{8,3}=Mueve(C{3,8});
C{4,5}=[   0        105.0 123.3      228.3;
         193.5      242.4   0         48.9];
C{5,4}=Mueve(C{4,5});
C{4,6}=[   0         33.3  208.2     241.5;
          91.2      105.0  123.3     137.1;
         193.5      242.4   0         48.9];
C{6,4}=Mueve(C{4,6});
C{4,7}=[    0        33.3  222.3      255.6;
          91.2      242.4   0         151.2];
C{7,4}=Mueve(C{4,7});
C{4,8}=[   0       242.4    0         242.4];
C{8,4}=Mueve(C{4,8});
%%%%%%%%%%%%%%%%%%%%%%%%
%CONFLICTOS POR ALCANCE
%%%%%%%%%%%%%%%%%%%%%%%%
C{1,1}=[0   228.3   0   228.3];
C{1,1}=Mueve(C{1,1});
C{1,2}=[0   33.3   0   33.3;
        0   105   118.2  241.5];
C{2,1}=Mueve(C{1,2});  
C{1,3}=[0       33.3        0   33.3;
        91.2    105     104.4   118.2;
        179.4   228.3   206.7   255.6];
C{3,1}=Mueve(C{1,3}); 
C{1,4}=[0       105     0       105;
        179.4   228.3   193.5   242.4];
C{4,1}=Mueve(C{1,4});
C{2,2}=[0       241.5   0       241.5];
C{2,3}=[0       118.2   0       118.2;
        192.6   241.5   206.7   255.6];
C{3,2}=Mueve(C{2,3});  
C{2,4}=[0       33.3    0       33.3;
       104.4   118.2   91.2      105 ;
       192.6   241.5   193.5     242.4];
C{4,2}=Mueve(C{2,4});  
C{3,3}=[0       255.6   0        255.6];
C{3,4}=[0       33.3    0        33.3;
        104.4   118.2   91.2     105;
        206.7   255.6   193.5    242.4];
C{4,3}=Mueve(C{3,4}); 
C{4,4}=[0       242.4   0        242.4];
%%%% otra direccion
C{5,5}=[0       228.3    0        228.3];
C{5,6}=[0       137.1    0        137.1;
        195     228.3   208.2     241.5];
C{6,5}=Mueve(C{5,6});
C{5,7}=[0       48.9    0        48.9;
        123.3   137.1   137.4    151.2;
        195     228.3   222.3    255.6];
C{7,5}=Mueve(C{5,7}); 
C{5,8}=[0       48.9    0        48.9;
        123.3   228.3   137.4    242.4];
C{8,5}=Mueve(C{5,8});
C{6,6}=[0       241.5    0        241.15];
C{6,7}=[0       48.9    0        48.9;
        137.1   241.5   151.2     255.6];
C{7,6}=Mueve(C{6,7}); 
C{6,8}=[0       48.9    0        48.9;
        123.3   137.1   137.42   151.4;
        208.2   241.5   209.1    242.4];                    
C{8,6}=Mueve(C{6,8}); 
C{7,7}=[0       255.6    0        255.6];
C{7,8}=[0       151.2    0        151.2;
        222.3   255.6   209.1     242.4];
C{8,7}=Mueve(C{7,8}); 
C{8,8}=[0       242.4    0        242.4];
    
Marcha=zeros(n_t,n_rutas);  % tipo conflicto:  1= frontal /  2 =alcance
Marcha(1:20,[1,2,3,4])=+1;   % tren y ruta (absoluta), hacia la derecha
Marcha(21:40,[5,6,7,8])=-1;   % hacia la izquierda
TVr=[228.3;241.5;255.6;242.4;228.3;241.5;255.6;242.4]; % distancia ruta 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%  asignacion rutas a trenes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 R{1}=[1,2,3,4]; % rutas para el tren 1
 R{2}=[1,2,3,4];
 R{3}=[1,2,3,4];
 R{4}=[1,2,3,4];
 R{5}=[1,2,3,4]; % rutas para el tren 1
 R{6}=[1,2,3,4];
 R{7}=[1,2,3,4];
 R{8}=[1,2,3,4];
 R{9}=[1,2,3,4]; % rutas para el tren 1
 R{10}=[1,2,3,4];
 R{11}=[1,2,3,4];
 R{12}=[1,2,3,4];
 R{13}=[1,2,3,4]; % rutas para el tren 1
 R{14}=[1,2,3,4]; % rutas para el tren 1
 R{15}=[1,2,3,4];
 R{16}=[1,2,3,4];
 R{17}=[1,2,3,4];
 R{18}=[1,2,3,4]; % rutas para el tren 1
 R{19}=[1,2,3,4];
 R{20}=[1,2,3,4];
 R{21}=[5,6,7,8]; % rutas para el tren 1
 R{22}=[5,6,7,8];
 R{23}=[5,6,7,8];
 R{24}=[5,6,7,8];
 R{25}=[5,6,7,8]; % rutas para el tren 1
 R{26}=[5,6,7,8];
 R{27}=[5,6,7,8];
 R{28}=[5,6,7,8];
 R{29}=[5,6,7,8]; % rutas para el tren 1
 R{30}=[5,6,7,8];
 R{31}=[5,6,7,8];
 R{32}=[5,6,7,8];
 R{33}=[5,6,7,8]; % rutas para el tren 1
 R{34}=[5,6,7,8]; % rutas para el tren 1
 R{35}=[5,6,7,8];
 R{36}=[5,6,7,8];
 R{37}=[5,6,7,8];
 R{38}=[5,6,7,8]; % rutas para el tren 1
 R{39}=[5,6,7,8];
 R{40}=[5,6,7,8];
  
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%% ordenacion procesamiento de trenes            %%%%%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
[t_pla,I]=InitOrden(initia,t_pla,n_t); % inicializacion del orden del procesamiento
at=at(I);
vt=vt.^(-1);
vt=vt(I);
Raux=R;
Marcha=Marcha(I,:);
for i=1:n_t
    R{i}=Raux{I(i)};
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%                 tiempo de viaje trenes
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 for t1=1:n_t
     for i_r=1:length(R{t1})
         D_t(t1,i_r)=TVr(R{t1}(i_r))*vt(t1)-at(t1);
     end
 end
 n_s=0; % numero máximo de conflicto entre un par de trenes
for t1=1:n_t-1
    for t2=t1+1:n_t
        for i_r1=1:length(R{t1})
            r1=R{t1}(i_r1);
            for i_r2=1:length(R{t2})
                r2=R{t2}(i_r2);
                if length(C{r1,r2})>0
                C_t{i_r1,i_r2,t1,t2}=[C{r1,r2}(:,1:2)*vt(t1) C{r1,r2}(:,3:4)*vt(t2)];
                C_t{i_r2,i_r1,t2,t1}=[C{r2,r1}(:,1:2)*vt(t2) C{r2,r1}(:,3:4)*vt(t1)];
                n_s=max(n_s,size(C_t{i_r1,i_r2,t1,t2},1));
                end
            end
        end
    end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    case 'Problem3' % P R O B L E M   3
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        switch version
            case 'a'
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%              TIEMPOS PLANIFICADOS DE SALIDA/LLEGADA
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                t_pla=[5:0.5:24.5 5:0.5:24.5];        % departure time planeado
                %t_pla=[0;0;0;0;0;0;0;0];       % departure time planeado
                % esta solucion viene bien para testar conflictos en misma direccion
                at= t_pla+1;     % desired arrive time
                %vt= [300;300;300;300;300;300;300;300]*0.25;          % velocidad del tren para calacular tiempos de viajes
                vt=ones(80,1)*175+unidrnd(5,80,1)*25;
                % referencia 100km/h -> 1 200Km/h->2
            case 'b'
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%              TIEMPOS PLANIFICADOS DE SALIDA/LLEGADA
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                t_pla=rand(80,1)*20 +5;        % departure time planeado
                %t_pla=[0;0;0;0;0;0;0;0];       % departure time planeado
                % esta solucion viene bien para testar conflictos en misma direccion
                at= t_pla+1;     % desired arrive time
                %vt= [300;300;300;300;300;300;300;300]*0.25;          % velocidad del tren para calacular tiempos de viajes
                vt=ones(80,1)*250;
                % referencia 100km/h -> 1 200Km/h->2
        end
        n_t=length(t_pla);  % número de trenes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%    RUTAS: MATRIZ DE CONFLICTOS Y TIEMPOS DE VIAJES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
n_rutas=8;
Mueve=@(A) [A(:,3) A(:,4) A(:,1) A(:,2)];
C{1,5}=[ 0        228.3     0        228.3];
C{5,1}=Mueve(C{1,5});
C{1,6}=[ 0         33.3   208.2      241.5;
        91.2      228.3     0        137.1];
C{6,1}=Mueve(C{1,6});
C{1,7}=[ 0         33.3   222.3      255.6;
        91.2      105.0   137.4      151.2;
       179.4      228.3     0         48.9];
C{7,1}=Mueve(C{1,7});
C{1,8}=[ 0        105.0   123.3       242.4;
       179.4      228.3     0          48.9];
C{8,1}=Mueve(C{1,8});
C{2,5}=[ 0         33.3   195        228.3;
       104.4      241.5     0        137.1];
C{5,2}=Mueve(C{2,5});
C{2,6}=[   0        241.5       0        241.5];
C{6,2}=Mueve(C{2,6});
C{2,7}=[   0        118.2   137.4      255.6;
         192.6      241.5       0         48.9];
C{7,2}=Mueve(C{2,7});   
C{2,8}=[   0         33.3   209.1      242.4;
         104.4      118.2   137.4      151.2;
         192.6      241.5       0        48.9];
C{8,2}=Mueve(C{2,8});
C{3,5}=[    0        33.3 195.0      228.3;
        104.4      118.2  123.3      137.1;
        206.7      255.6    0         48.9];
C{5,3}=Mueve(C{3,5});
C{3,6}=[     0      118.2 123.3      241.5;
        206.7      255.6    0         48.9];
C{6,3}=Mueve(C{3,6});
C{3,7}=[     0      255.6   0        255.6];
C{7,3}=Mueve(C{3,7});
C{3,8}=[     0       33.3 209.1      242.4;
         104.4      255.6   0        151.2];
C{8,3}=Mueve(C{3,8});
C{4,5}=[   0        105.0 123.3      228.3;
         193.5      242.4   0         48.9];
C{5,4}=Mueve(C{4,5});
C{4,6}=[   0         33.3  208.2     241.5;
          91.2      105.0  123.3     137.1;
         193.5      242.4   0         48.9];
C{6,4}=Mueve(C{4,6});
C{4,7}=[    0        33.3  222.3      255.6;
          91.2      242.4   0         151.2];
C{7,4}=Mueve(C{4,7});
C{4,8}=[   0       242.4    0         242.4];
C{8,4}=Mueve(C{4,8});
%%%%%%%%%%%%%%%%%%%%%%%%
%CONFLICTOS POR ALCANCE
%%%%%%%%%%%%%%%%%%%%%%%%
C{1,1}=[0   228.3   0   228.3];
C{1,1}=Mueve(C{1,1});
C{1,2}=[0   33.3   0   33.3;
        0   105   118.2  241.5];
C{2,1}=Mueve(C{1,2});  
C{1,3}=[0       33.3        0   33.3;
        91.2    105     104.4   118.2;
        179.4   228.3   206.7   255.6];
C{3,1}=Mueve(C{1,3}); 
C{1,4}=[0       105     0       105;
        179.4   228.3   193.5   242.4];
C{4,1}=Mueve(C{1,4});
C{2,2}=[0       241.5   0       241.5]
C{2,3}=[0       118.2   0       118.2;
        192.6   241.5   206.7   255.6];
C{3,2}=Mueve(C{2,3});  
C{2,4}=[0       33.3    0       33.3;
       104.4   118.2   91.2      105 ;
       192.6   241.5   193.5     242.4];
C{4,2}=Mueve(C{2,4});  
C{3,3}=[0       255.6   0        255.6];
C{3,4}=[0       33.3    0        33.3;
        104.4   118.2   91.2     105;
        206.7   255.6   193.5    242.4];
C{4,3}=Mueve(C{3,4}); 
C{4,4}=[0       242.4   0        242.4];
%%%% otra direccion
C{5,5}=[0       228.3    0        228.3];
C{5,6}=[0       137.1    0        137.1;
        195     228.3   208.2     241.5];
C{6,5}=Mueve(C{5,6});
C{5,7}=[0       48.9    0        48.9;
        123.3   137.1   137.4    151.2;
        195     228.3   222.3    255.6];
C{7,5}=Mueve(C{5,7}); 
C{5,8}=[0       48.9    0        48.9;
        123.3   228.3   137.4    242.4];
C{8,5}=Mueve(C{5,8});
C{6,6}=[0       241.5    0        241.15];
C{6,7}=[0       48.9    0        48.9;
        137.1   241.5   151.2     255.6];
C{7,6}=Mueve(C{6,7}); 
C{6,8}=[0       48.9    0        48.9;
        123.3   137.1   137.42   151.4;
        208.2   241.5   209.1    242.4];                    
C{8,6}=Mueve(C{6,8}); 
C{7,7}=[0       255.6    0        255.6];
C{7,8}=[0       151.2    0        151.2;
        222.3   255.6   209.1     242.4];
C{8,7}=Mueve(C{7,8}); 
C{8,8}=[0       242.4    0        242.4];
    
Marcha=zeros(n_t,n_rutas);  % tipo conflicto:  1= frontal /  2 =alcance
Marcha(1:40,[1,2,3,4])=+1;   % tren y ruta (absoluta), hacia la derecha
Marcha(41:80,[5,6,7,8])=-1;   % hacia la izquierda
TVr=[228.3;241.5;255.6;242.4;228.3;241.5;255.6;242.4]; % distancia ruta 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%  asignacion rutas a trenes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 R{1}=[1,2,3,4]; % rutas para el tren 1
 R{2}=[1,2,3,4];
 R{3}=[1,2,3,4];
 R{4}=[1,2,3,4];
 R{5}=[1,2,3,4]; % rutas para el tren 1
 R{6}=[1,2,3,4];
 R{7}=[1,2,3,4];
 R{8}=[1,2,3,4];
 R{9}=[1,2,3,4]; % rutas para el tren 1
 R{10}=[1,2,3,4];
 R{11}=[1,2,3,4];
 R{12}=[1,2,3,4];
 R{13}=[1,2,3,4]; % rutas para el tren 1
 R{14}=[1,2,3,4]; % rutas para el tren 1
 R{15}=[1,2,3,4];
 R{16}=[1,2,3,4];
 R{17}=[1,2,3,4];
 R{18}=[1,2,3,4]; % rutas para el tren 1
 R{19}=[1,2,3,4];
 R{20}=[1,2,3,4];
 R{21}=[1,2,3,4]; % rutas para el tren 1
 R{22}=[1,2,3,4];
 R{23}=[1,2,3,4];
 R{24}=[1,2,3,4];
 R{25}=[1,2,3,4]; % rutas para el tren 1
 R{26}=[1,2,3,4];
 R{27}=[1,2,3,4];
 R{28}=[1,2,3,4];
 R{29}=[1,2,3,4]; % rutas para el tren 1
 R{30}=[1,2,3,4];
 R{31}=[1,2,3,4];
 R{32}=[1,2,3,4];
 R{33}=[1,2,3,4]; % rutas para el tren 1
 R{34}=[1,2,3,4]; % rutas para el tren 1
 R{35}=[1,2,3,4];
 R{36}=[1,2,3,4];
 R{37}=[1,2,3,4];
 R{38}=[1,2,3,4]; % rutas para el tren 1
 R{39}=[1,2,3,4];
 R{40}=[1,2,3,4];
 R{41}=[5,6,7,8]; % rutas para el tren 1
 R{42}=[5,6,7,8];
 R{43}=[5,6,7,8];
 R{44}=[5,6,7,8];
 R{45}=[5,6,7,8]; % rutas para el tren 1
 R{46}=[5,6,7,8];
 R{47}=[5,6,7,8];
 R{48}=[5,6,7,8];
 R{49}=[5,6,7,8]; % rutas para el tren 1
 R{50}=[5,6,7,8];
 R{51}=[5,6,7,8];
 R{52}=[5,6,7,8];
 R{53}=[5,6,7,8]; % rutas para el tren 1
 R{54}=[5,6,7,8]; % rutas para el tren 1
 R{55}=[5,6,7,8];
 R{56}=[5,6,7,8];
 R{57}=[5,6,7,8];
 R{58}=[5,6,7,8]; % rutas para el tren 1
 R{59}=[5,6,7,8];
 R{60}=[5,6,7,8];
 R{61}=[5,6,7,8]; % rutas para el tren 1
 R{62}=[5,6,7,8];
 R{63}=[5,6,7,8];
 R{64}=[5,6,7,8];
 R{65}=[5,6,7,8]; % rutas para el tren 1
 R{66}=[5,6,7,8];
 R{67}=[5,6,7,8];
 R{68}=[5,6,7,8];
 R{69}=[5,6,7,8]; % rutas para el tren 1
 R{70}=[5,6,7,8];
 R{71}=[5,6,7,8];
 R{72}=[5,6,7,8];
 R{73}=[5,6,7,8]; % rutas para el tren 1
 R{74}=[5,6,7,8]; % rutas para el tren 1
 R{75}=[5,6,7,8];
 R{76}=[5,6,7,8];
 R{77}=[5,6,7,8];
 R{78}=[5,6,7,8]; % rutas para el tren 1
 R{79}=[5,6,7,8];
 R{80}=[5,6,7,8];
  
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%% ordenacion procesamiento de trenes            %%%%%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
[t_pla,I]=InitOrden(initia,t_pla,n_t); % inicializacion del orden del procesamiento
at=at(I);
vt=vt.^(-1);
vt=vt(I);
Raux=R;
Marcha=Marcha(I,:);
for i=1:n_t
    R{i}=Raux{I(i)};
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%                 tiempo de viaje trenes
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 for t1=1:n_t
     for i_r=1:length(R{t1})
         D_t(t1,i_r)=TVr(R{t1}(i_r))*vt(t1)-at(t1);
     end
 end
 n_s=0; % numero máximo de conflicto entre un par de trenes
for t1=1:n_t-1
    for t2=t1+1:n_t
        for i_r1=1:length(R{t1})
            r1=R{t1}(i_r1);
            for i_r2=1:length(R{t2})
                r2=R{t2}(i_r2);
                if length(C{r1,r2})>0
                C_t{i_r1,i_r2,t1,t2}=[C{r1,r2}(:,1:2)*vt(t1) C{r1,r2}(:,3:4)*vt(t2)];
                C_t{i_r2,i_r1,t2,t1}=[C{r2,r1}(:,1:2)*vt(t2) C{r2,r1}(:,3:4)*vt(t1)];
                n_s=max(n_s,size(C_t{i_r1,i_r2,t1,t2},1));
                end
            end
        end
    end
end
%%%%%%%%%%%%% INICIO PROBLEMA4
% entre inicio y fin de problema4 se tiene que insertar
% el codigo generado por mainGenerarA.m mainGenerarB.m mainGenerarC.m
% de la carpeta GenerarProblemaReal
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
    case 'Problem4aS' % P R O B L E M   4 
        % Problem4--> ATOCHA
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%    RUTAS: MATRIZ DE CONFLICTOS Y TIEMPOS DE VIAJES 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
Mueve=@(A) [A(:,3) A(:,4) A(:,1) A(:,2)]; 
n_rutas=7 ;  
t_pla=[5.233 ; 5.417 ; 5.700 ; 5.900 ; 6.050 ; 6.250 ; 6.633 ; 6.883 ; 7.133 ; 7.350 ; 7.500 ; 7.850 ; 7.967 ; 5.217 ; 6.500 ; 6.717 ; 7.000 ; 7.700 ; 5.983 ; 6.267 ; 6.517 ; 6.750 ; 6.983 ; 7.167 ; 7.367 ; 7.567 ; 7.750 ; 7.967 ; 6.433 ; 6.650 ; 6.933 ; 7.633 ; 7.950 ; ]; 
t_pla=SimulacionRetraso(t_pla,version);
at=[5.321 ; 5.504 ; 5.788 ; 5.988 ; 6.138 ; 6.338 ; 6.721 ; 6.971 ; 7.221 ; 7.438 ; 7.588 ; 7.938 ; 8.054 ; 5.304 ; 6.588 ; 6.804 ; 7.088 ; 7.788 ; 6.071 ; 6.354 ; 6.604 ; 6.838 ; 7.071 ; 7.254 ; 7.454 ; 7.654 ; 7.838 ; 8.054 ; 6.521 ; 6.737 ; 7.021 ; 7.721 ; 8.037 ; ]; 
vt=[40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; ]; 
n_t=length(t_pla);  % número de trenes 
Ntipotren=[1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; ]; 
tipotren={'C2+','','C2-','','C7+','','C7-','','C5+','','C5-','','C4+','','C4-','','C3+','','C3-'}; 
C{1,1}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
]; 
C{1,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,3}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{3,4}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,5}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,6}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,7}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{4,4}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{4,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,6}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{7,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{1,1}=Mueve(C{1,1}); 
C{2,1}=Mueve(C{1,2}); 
C{3,1}=Mueve(C{1,3}); 
C{4,1}=Mueve(C{1,4}); 
C{5,1}=Mueve(C{1,5}); 
C{6,1}=Mueve(C{1,6}); 
C{7,1}=Mueve(C{1,7}); 
C{2,2}=Mueve(C{2,2}); 
C{3,2}=Mueve(C{2,3}); 
C{4,2}=Mueve(C{2,4}); 
C{5,2}=Mueve(C{2,5}); 
C{6,2}=Mueve(C{2,6}); 
C{7,2}=Mueve(C{2,7}); 
C{3,3}=Mueve(C{3,3}); 
C{4,3}=Mueve(C{3,4}); 
C{5,3}=Mueve(C{3,5}); 
C{6,3}=Mueve(C{3,6}); 
C{7,3}=Mueve(C{3,7}); 
C{4,4}=Mueve(C{4,4}); 
C{5,4}=Mueve(C{4,5}); 
C{6,4}=Mueve(C{4,6}); 
C{7,4}=Mueve(C{4,7}); 
C{5,5}=Mueve(C{5,5}); 
C{6,5}=Mueve(C{5,6}); 
C{7,5}=Mueve(C{5,7}); 
C{6,6}=Mueve(C{6,6}); 
C{7,6}=Mueve(C{6,7}); 
C{7,7}=Mueve(C{7,7}); 
Marcha=zeros(n_t,n_rutas); 
Marcha(1:18,[1,2,3])=+1; 
Marcha(19:33,[4,5,6,7])=-1; 
TVr=[3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%  asignacion rutas a trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
R{1}=[3]; 
R{2}=[3]; 
R{3}=[3]; 
R{4}=[3]; 
R{5}=[3]; 
R{6}=[3]; 
R{7}=[3]; 
R{8}=[3]; 
R{9}=[3]; 
R{10}=[3]; 
R{11}=[3]; 
R{12}=[3]; 
R{13}=[3]; 
R{14}=[1,2]; 
R{15}=[1,2]; 
R{16}=[1,2]; 
R{17}=[1,2]; 
R{18}=[1,2]; 
R{19}=[6,7]; 
R{20}=[6,7]; 
R{21}=[6,7]; 
R{22}=[6,7]; 
R{23}=[6,7]; 
R{24}=[6,7]; 
R{25}=[6,7]; 
R{26}=[6,7]; 
R{27}=[6,7]; 
R{28}=[6,7]; 
R{29}=[4,5]; 
R{30}=[4,5]; 
R{31}=[4,5]; 
R{32}=[4,5]; 
R{33}=[4,5]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%% ordenacion procesamiento de trenes            %%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
[t_pla,I]=InitOrden(initia,t_pla,n_t); % inicializacion del orden del procesamiento
at=at(I); 
vt=vt.^(-1); 
vt=vt(I); 
Ntipotren=Ntipotren(I); 
Raux=R; 
Marcha=Marcha(I,:); 
for i=1:n_t 
   R{i}=Raux{I(i)}; 
end 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 %%%                 tiempo de viaje trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 for t1=1:n_t 
     for i_r=1:length(R{t1}) 
         D_t(t1,i_r)=TVr(R{t1}(i_r))*vt(t1)-at(t1); 
     end 
 end 
 n_s=0; % numero máximo de conflicto entre un par de trenes 
for t1=1:n_t-1 
    for t2=t1+1:n_t 
        for i_r1=1:length(R{t1}) 
            r1=R{t1}(i_r1); 
            for i_r2=1:length(R{t2}) 
                r2=R{t2}(i_r2); 
                if length(C{r1,r2})>0 
                C_t{i_r1,i_r2,t1,t2}=[C{r1,r2}(:,1:2)*vt(t1) C{r1,r2}(:,3:4)*vt(t2)]; 
                C_t{i_r2,i_r1,t2,t1}=[C{r2,r1}(:,1:2)*vt(t2) C{r2,r1}(:,3:4)*vt(t1)]; 
                n_s=max(n_s,size(C_t{i_r1,i_r2,t1,t2},1)); 
                end 
            end 
        end 
    end 
end 
%%%%%%%%%%%%% FIN PROBLEMA4aS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
    case 'Problem4bS' % P R O B L E M   4 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%    RUTAS: MATRIZ DE CONFLICTOS Y TIEMPOS DE VIAJES 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
Mueve=@(A) [A(:,3) A(:,4) A(:,1) A(:,2)]; 
n_rutas=13 ;  
t_pla=[5.233 ; 5.417 ; 5.700 ; 5.900 ; 6.050 ; 6.250 ; 6.633 ; 6.883 ; 7.133 ; 7.350 ; 7.500 ; 7.850 ; 7.967 ; 5.217 ; 6.500 ; 6.717 ; 7.000 ; 7.700 ; 4.950 ; 5.400 ; 5.600 ; 5.750 ; 5.800 ; 5.950 ; 6.000 ; 6.200 ; 6.300 ; 6.400 ; 6.517 ; 6.633 ; 6.750 ; 6.800 ; 6.900 ; 7.000 ; 7.100 ; 7.200 ; 7.333 ; 7.450 ; 7.550 ; 7.600 ; 7.700 ; 7.783 ; 7.900 ; 8.000 ; 5.983 ; 6.267 ; 6.517 ; 6.750 ; 6.983 ; 7.167 ; 7.367 ; 7.567 ; 7.750 ; 7.967 ; 6.433 ; 6.650 ; 6.933 ; 7.633 ; 7.950 ; 6.033 ; 6.333 ; 6.567 ; 6.833 ; 7.133 ; 7.367 ; 7.533 ; 7.633 ; 7.817 ; 5.583 ; 5.783 ; 5.983 ; 6.183 ; 6.283 ; 6.383 ; 6.483 ; 6.617 ; 6.733 ; 6.783 ; 6.883 ; 6.983 ; 7.083 ; 7.183 ; 7.317 ; 7.433 ; 7.583 ; 7.683 ; 7.767 ; 7.883 ; 7.983 ; ]; 
t_pla=SimulacionRetraso(t_pla,version);  
at=[5.321 ; 5.504 ; 5.788 ; 5.988 ; 6.138 ; 6.338 ; 6.721 ; 6.971 ; 7.221 ; 7.438 ; 7.588 ; 7.938 ; 8.054 ; 5.304 ; 6.588 ; 6.804 ; 7.088 ; 7.788 ; 5.038 ; 5.488 ; 5.688 ; 5.838 ; 5.888 ; 6.038 ; 6.088 ; 6.288 ; 6.388 ; 6.488 ; 6.604 ; 6.721 ; 6.838 ; 6.888 ; 6.988 ; 7.088 ; 7.188 ; 7.288 ; 7.421 ; 7.537 ; 7.638 ; 7.688 ; 7.788 ; 7.871 ; 7.988 ; 8.088 ; 6.071 ; 6.354 ; 6.604 ; 6.838 ; 7.071 ; 7.254 ; 7.454 ; 7.654 ; 7.838 ; 8.054 ; 6.521 ; 6.737 ; 7.021 ; 7.721 ; 8.037 ; 6.121 ; 6.421 ; 6.654 ; 6.921 ; 7.221 ; 7.454 ; 7.621 ; 7.721 ; 7.904 ; 5.671 ; 5.871 ; 6.071 ; 6.271 ; 6.371 ; 6.471 ; 6.571 ; 6.704 ; 6.821 ; 6.871 ; 6.971 ; 7.071 ; 7.171 ; 7.271 ; 7.404 ; 7.521 ; 7.671 ; 7.771 ; 7.854 ; 7.971 ; 8.071 ; ]; 
vt=[40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; ]; 
n_t=length(t_pla);  % número de trenes 
Ntipotren=[1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; ]; 
tipotren={'C2+','','C2-','','C7+','','C7-','','C5+','','C5-','','C4+','','C4-','','C3+','','C3-'}; 
C{1,1}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
]; 
C{1,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,3}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{3,4}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,5}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,6}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,7}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{4,4}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{4,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,6}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{7,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{8,8}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{8,9}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{9,9}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{9,10}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    1.250 	    3.450 	    0.250 	    2.450  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{9,11}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{9,12}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{9,13}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    1.250 	    3.450 	    0.250 	    2.450  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{10,10}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{10,11}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{10,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{10,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,11}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{12,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{12,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{13,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{1,1}=Mueve(C{1,1}); 
C{2,1}=Mueve(C{1,2}); 
C{3,1}=Mueve(C{1,3}); 
C{4,1}=Mueve(C{1,4}); 
C{5,1}=Mueve(C{1,5}); 
C{6,1}=Mueve(C{1,6}); 
C{7,1}=Mueve(C{1,7}); 
C{2,2}=Mueve(C{2,2}); 
C{3,2}=Mueve(C{2,3}); 
C{4,2}=Mueve(C{2,4}); 
C{5,2}=Mueve(C{2,5}); 
C{6,2}=Mueve(C{2,6}); 
C{7,2}=Mueve(C{2,7}); 
C{3,3}=Mueve(C{3,3}); 
C{4,3}=Mueve(C{3,4}); 
C{5,3}=Mueve(C{3,5}); 
C{6,3}=Mueve(C{3,6}); 
C{7,3}=Mueve(C{3,7}); 
C{4,4}=Mueve(C{4,4}); 
C{5,4}=Mueve(C{4,5}); 
C{6,4}=Mueve(C{4,6}); 
C{7,4}=Mueve(C{4,7}); 
C{5,5}=Mueve(C{5,5}); 
C{6,5}=Mueve(C{5,6}); 
C{7,5}=Mueve(C{5,7}); 
C{6,6}=Mueve(C{6,6}); 
C{7,6}=Mueve(C{6,7}); 
C{7,7}=Mueve(C{7,7}); 
C{8,8}=Mueve(C{8,8}); 
C{9,8}=Mueve(C{8,9}); 
C{9,9}=Mueve(C{9,9}); 
C{10,9}=Mueve(C{9,10}); 
C{11,9}=Mueve(C{9,11}); 
C{12,9}=Mueve(C{9,12}); 
C{13,9}=Mueve(C{9,13}); 
C{10,10}=Mueve(C{10,10}); 
C{11,10}=Mueve(C{10,11}); 
C{12,10}=Mueve(C{10,12}); 
C{13,10}=Mueve(C{10,13}); 
C{11,11}=Mueve(C{11,11}); 
C{12,11}=Mueve(C{11,12}); 
C{13,11}=Mueve(C{11,13}); 
C{12,12}=Mueve(C{12,12}); 
C{13,12}=Mueve(C{12,13}); 
C{13,13}=Mueve(C{13,13}); 
Marcha=zeros(n_t,n_rutas); 
Marcha(1:44,[1,2,3,8,9])=+1; 
Marcha(45:89,[4,5,6,7,10,11,12,13])=-1; 
TVr=[3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%  asignacion rutas a trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
R{1}=[3]; 
R{2}=[3]; 
R{3}=[3]; 
R{4}=[3]; 
R{5}=[3]; 
R{6}=[3]; 
R{7}=[3]; 
R{8}=[3]; 
R{9}=[3]; 
R{10}=[3]; 
R{11}=[3]; 
R{12}=[3]; 
R{13}=[3]; 
R{14}=[1,2]; 
R{15}=[1,2]; 
R{16}=[1,2]; 
R{17}=[1,2]; 
R{18}=[1,2]; 
R{19}=[8,9]; 
R{20}=[8,9]; 
R{21}=[8,9]; 
R{22}=[8,9]; 
R{23}=[8,9]; 
R{24}=[8,9]; 
R{25}=[8,9]; 
R{26}=[8,9]; 
R{27}=[8,9]; 
R{28}=[8,9]; 
R{29}=[8,9]; 
R{30}=[8,9]; 
R{31}=[8,9]; 
R{32}=[8,9]; 
R{33}=[8,9]; 
R{34}=[8,9]; 
R{35}=[8,9]; 
R{36}=[8,9]; 
R{37}=[8,9]; 
R{38}=[8,9]; 
R{39}=[8,9]; 
R{40}=[8,9]; 
R{41}=[8,9]; 
R{42}=[8,9]; 
R{43}=[8,9]; 
R{44}=[8,9]; 
R{45}=[6,7]; 
R{46}=[6,7]; 
R{47}=[6,7]; 
R{48}=[6,7]; 
R{49}=[6,7]; 
R{50}=[6,7]; 
R{51}=[6,7]; 
R{52}=[6,7]; 
R{53}=[6,7]; 
R{54}=[6,7]; 
R{55}=[4,5]; 
R{56}=[4,5]; 
R{57}=[4,5]; 
R{58}=[4,5]; 
R{59}=[4,5]; 
R{60}=[10,11]; 
R{61}=[10,11]; 
R{62}=[10,11]; 
R{63}=[10,11]; 
R{64}=[10,11]; 
R{65}=[10,11]; 
R{66}=[10,11]; 
R{67}=[10,11]; 
R{68}=[10,11]; 
R{69}=[12,13]; 
R{70}=[12,13]; 
R{71}=[12,13]; 
R{72}=[12,13]; 
R{73}=[12,13]; 
R{74}=[12,13]; 
R{75}=[12,13]; 
R{76}=[12,13]; 
R{77}=[12,13]; 
R{78}=[12,13]; 
R{79}=[12,13]; 
R{80}=[12,13]; 
R{81}=[12,13]; 
R{82}=[12,13]; 
R{83}=[12,13]; 
R{84}=[12,13]; 
R{85}=[12,13]; 
R{86}=[12,13]; 
R{87}=[12,13]; 
R{88}=[12,13]; 
R{89}=[12,13]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%% ordenacion procesamiento de trenes            %%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
[t_pla,I]=InitOrden(initia,t_pla,n_t); % inicializacion del orden del procesamiento
at=at(I); 
vt=vt.^(-1); 
vt=vt(I); 
Ntipotren=Ntipotren(I); 
Raux=R; 
Marcha=Marcha(I,:); 
for i=1:n_t 
   R{i}=Raux{I(i)}; 
end 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 %%%                 tiempo de viaje trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 for t1=1:n_t 
     for i_r=1:length(R{t1}) 
         D_t(t1,i_r)=TVr(R{t1}(i_r))*vt(t1)-at(t1); 
     end 
 end 
 n_s=0; % numero máximo de conflicto entre un par de trenes 
for t1=1:n_t-1 
    for t2=t1+1:n_t 
        for i_r1=1:length(R{t1}) 
            r1=R{t1}(i_r1); 
            for i_r2=1:length(R{t2}) 
                r2=R{t2}(i_r2); 
                if length(C{r1,r2})>0 
                C_t{i_r1,i_r2,t1,t2}=[C{r1,r2}(:,1:2)*vt(t1) C{r1,r2}(:,3:4)*vt(t2)]; 
                C_t{i_r2,i_r1,t2,t1}=[C{r2,r1}(:,1:2)*vt(t2) C{r2,r1}(:,3:4)*vt(t1)]; 
                n_s=max(n_s,size(C_t{i_r1,i_r2,t1,t2},1)); 
                end 
            end 
        end 
    end 
end 
%%%%%%%%%%%%% FIN PROBLEMA4bS

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
    case 'Problem4cS' % P R O B L E M   4 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%    RUTAS: MATRIZ DE CONFLICTOS Y TIEMPOS DE VIAJES 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
Mueve=@(A) [A(:,3) A(:,4) A(:,1) A(:,2)]; 
n_rutas=17 ;  
t_pla=[5.233 ; 5.417 ; 5.700 ; 5.900 ; 6.050 ; 6.250 ; 6.633 ; 6.883 ; 7.133 ; 7.350 ; 7.500 ; 7.850 ; 7.967 ; 5.217 ; 6.500 ; 6.717 ; 7.000 ; 7.700 ; 4.950 ; 5.400 ; 5.600 ; 5.750 ; 5.800 ; 5.950 ; 6.000 ; 6.200 ; 6.300 ; 6.400 ; 6.517 ; 6.633 ; 6.750 ; 6.800 ; 6.900 ; 7.000 ; 7.100 ; 7.200 ; 7.333 ; 7.450 ; 7.550 ; 7.600 ; 7.700 ; 7.783 ; 7.900 ; 8.000 ; 5.417 ; 5.733 ; 6.017 ; 6.183 ; 6.350 ; 6.517 ; 6.683 ; 6.850 ; 6.983 ; 7.100 ; 7.183 ; 7.267 ; 7.350 ; 7.433 ; 7.517 ; 7.600 ; 7.667 ; 7.733 ; 7.800 ; 7.867 ; 7.933 ; 8.000 ; 5.983 ; 6.267 ; 6.517 ; 6.750 ; 6.983 ; 7.167 ; 7.367 ; 7.567 ; 7.750 ; 7.967 ; 6.433 ; 6.650 ; 6.933 ; 7.633 ; 7.950 ; 6.033 ; 6.333 ; 6.567 ; 6.833 ; 7.133 ; 7.367 ; 7.533 ; 7.633 ; 7.817 ; 5.583 ; 5.783 ; 5.983 ; 6.183 ; 6.283 ; 6.383 ; 6.483 ; 6.617 ; 6.733 ; 6.783 ; 6.883 ; 6.983 ; 7.083 ; 7.183 ; 7.317 ; 7.433 ; 7.583 ; 7.683 ; 7.767 ; 7.883 ; 7.983 ; 5.617 ; 5.933 ; 6.100 ; 6.267 ; 6.433 ; 6.600 ; 6.767 ; 6.867 ; 6.950 ; 7.033 ; 7.117 ; 7.200 ; 7.283 ; 7.367 ; 7.450 ; 7.533 ; 7.617 ; 7.700 ; 7.783 ; 7.867 ; 7.950 ; ]; 
t_pla=SimulacionRetraso(t_pla,version);
at=[5.321 ; 5.504 ; 5.788 ; 5.988 ; 6.138 ; 6.338 ; 6.721 ; 6.971 ; 7.221 ; 7.438 ; 7.588 ; 7.938 ; 8.054 ; 5.304 ; 6.588 ; 6.804 ; 7.088 ; 7.788 ; 5.038 ; 5.488 ; 5.688 ; 5.838 ; 5.888 ; 6.038 ; 6.088 ; 6.288 ; 6.388 ; 6.488 ; 6.604 ; 6.721 ; 6.838 ; 6.888 ; 6.988 ; 7.088 ; 7.188 ; 7.288 ; 7.421 ; 7.537 ; 7.638 ; 7.688 ; 7.788 ; 7.871 ; 7.988 ; 8.088 ; 5.504 ; 5.821 ; 6.104 ; 6.271 ; 6.438 ; 6.604 ; 6.771 ; 6.938 ; 7.071 ; 7.188 ; 7.271 ; 7.354 ; 7.438 ; 7.521 ; 7.604 ; 7.688 ; 7.754 ; 7.821 ; 7.888 ; 7.954 ; 8.021 ; 8.088 ; 6.071 ; 6.354 ; 6.604 ; 6.838 ; 7.071 ; 7.254 ; 7.454 ; 7.654 ; 7.838 ; 8.054 ; 6.521 ; 6.737 ; 7.021 ; 7.721 ; 8.037 ; 6.121 ; 6.421 ; 6.654 ; 6.921 ; 7.221 ; 7.454 ; 7.621 ; 7.721 ; 7.904 ; 5.671 ; 5.871 ; 6.071 ; 6.271 ; 6.371 ; 6.471 ; 6.571 ; 6.704 ; 6.821 ; 6.871 ; 6.971 ; 7.071 ; 7.171 ; 7.271 ; 7.404 ; 7.521 ; 7.671 ; 7.771 ; 7.854 ; 7.971 ; 8.071 ; 5.704 ; 6.021 ; 6.188 ; 6.354 ; 6.521 ; 6.688 ; 6.854 ; 6.954 ; 7.038 ; 7.121 ; 7.204 ; 7.288 ; 7.371 ; 7.454 ; 7.537 ; 7.621 ; 7.704 ; 7.788 ; 7.871 ; 7.954 ; 8.037 ; ]; 
vt=[40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; ]; 
n_t=length(t_pla);  % número de trenes 
Ntipotren=[1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; ]; 
tipotren={'C2+','','C2-','','C7+','','C7-','','C5+','','C5-','','C4+','','C4-','','C3+','','C3-'}; 
C{1,1}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
]; 
C{1,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,3}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{3,4}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,5}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,6}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,7}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{4,4}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{4,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,6}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{7,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{8,8}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{8,9}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{9,9}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{9,10}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    1.250 	    3.450 	    0.250 	    2.450  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{9,11}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{9,12}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{9,13}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    1.250 	    3.450 	    0.250 	    2.450  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{10,10}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{10,11}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{10,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{10,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,11}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{12,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{12,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{13,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{14,14}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{14,15}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{14,17}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{15,15}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{15,17}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    1.250 	    3.450 	    0.250 	    2.450  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{16,16}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{16,17}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{17,17}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{1,1}=Mueve(C{1,1}); 
C{2,1}=Mueve(C{1,2}); 
C{3,1}=Mueve(C{1,3}); 
C{4,1}=Mueve(C{1,4}); 
C{5,1}=Mueve(C{1,5}); 
C{6,1}=Mueve(C{1,6}); 
C{7,1}=Mueve(C{1,7}); 
C{2,2}=Mueve(C{2,2}); 
C{3,2}=Mueve(C{2,3}); 
C{4,2}=Mueve(C{2,4}); 
C{5,2}=Mueve(C{2,5}); 
C{6,2}=Mueve(C{2,6}); 
C{7,2}=Mueve(C{2,7}); 
C{3,3}=Mueve(C{3,3}); 
C{4,3}=Mueve(C{3,4}); 
C{5,3}=Mueve(C{3,5}); 
C{6,3}=Mueve(C{3,6}); 
C{7,3}=Mueve(C{3,7}); 
C{4,4}=Mueve(C{4,4}); 
C{5,4}=Mueve(C{4,5}); 
C{6,4}=Mueve(C{4,6}); 
C{7,4}=Mueve(C{4,7}); 
C{5,5}=Mueve(C{5,5}); 
C{6,5}=Mueve(C{5,6}); 
C{7,5}=Mueve(C{5,7}); 
C{6,6}=Mueve(C{6,6}); 
C{7,6}=Mueve(C{6,7}); 
C{7,7}=Mueve(C{7,7}); 
C{8,8}=Mueve(C{8,8}); 
C{9,8}=Mueve(C{8,9}); 
C{9,9}=Mueve(C{9,9}); 
C{10,9}=Mueve(C{9,10}); 
C{11,9}=Mueve(C{9,11}); 
C{12,9}=Mueve(C{9,12}); 
C{13,9}=Mueve(C{9,13}); 
C{10,10}=Mueve(C{10,10}); 
C{11,10}=Mueve(C{10,11}); 
C{12,10}=Mueve(C{10,12}); 
C{13,10}=Mueve(C{10,13}); 
C{11,11}=Mueve(C{11,11}); 
C{12,11}=Mueve(C{11,12}); 
C{13,11}=Mueve(C{11,13}); 
C{12,12}=Mueve(C{12,12}); 
C{13,12}=Mueve(C{12,13}); 
C{13,13}=Mueve(C{13,13}); 
C{14,14}=Mueve(C{14,14}); 
C{15,14}=Mueve(C{14,15}); 
C{17,14}=Mueve(C{14,17}); 
C{15,15}=Mueve(C{15,15}); 
C{17,15}=Mueve(C{15,17}); 
C{16,16}=Mueve(C{16,16}); 
C{17,16}=Mueve(C{16,17}); 
C{17,17}=Mueve(C{17,17}); 
Marcha=zeros(n_t,n_rutas); 
Marcha(1:66,[1,2,3,8,9,14,15])=+1; 
Marcha(67:132,[4,5,6,7,10,11,12,13,16,17])=-1; 
TVr=[3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%  asignacion rutas a trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
R{1}=[3]; 
R{2}=[3]; 
R{3}=[3]; 
R{4}=[3]; 
R{5}=[3]; 
R{6}=[3]; 
R{7}=[3]; 
R{8}=[3]; 
R{9}=[3]; 
R{10}=[3]; 
R{11}=[3]; 
R{12}=[3]; 
R{13}=[3]; 
R{14}=[1,2]; 
R{15}=[1,2]; 
R{16}=[1,2]; 
R{17}=[1,2]; 
R{18}=[1,2]; 
R{19}=[8,9]; 
R{20}=[8,9]; 
R{21}=[8,9]; 
R{22}=[8,9]; 
R{23}=[8,9]; 
R{24}=[8,9]; 
R{25}=[8,9]; 
R{26}=[8,9]; 
R{27}=[8,9]; 
R{28}=[8,9]; 
R{29}=[8,9]; 
R{30}=[8,9]; 
R{31}=[8,9]; 
R{32}=[8,9]; 
R{33}=[8,9]; 
R{34}=[8,9]; 
R{35}=[8,9]; 
R{36}=[8,9]; 
R{37}=[8,9]; 
R{38}=[8,9]; 
R{39}=[8,9]; 
R{40}=[8,9]; 
R{41}=[8,9]; 
R{42}=[8,9]; 
R{43}=[8,9]; 
R{44}=[8,9]; 
R{45}=[14,15]; 
R{46}=[14,15]; 
R{47}=[14,15]; 
R{48}=[14,15]; 
R{49}=[14,15]; 
R{50}=[14,15]; 
R{51}=[14,15]; 
R{52}=[14,15]; 
R{53}=[14,15]; 
R{54}=[14,15]; 
R{55}=[14,15]; 
R{56}=[14,15]; 
R{57}=[14,15]; 
R{58}=[14,15]; 
R{59}=[14,15]; 
R{60}=[14,15]; 
R{61}=[14,15]; 
R{62}=[14,15]; 
R{63}=[14,15]; 
R{64}=[14,15]; 
R{65}=[14,15]; 
R{66}=[14,15]; 
R{67}=[6,7]; 
R{68}=[6,7]; 
R{69}=[6,7]; 
R{70}=[6,7]; 
R{71}=[6,7]; 
R{72}=[6,7]; 
R{73}=[6,7]; 
R{74}=[6,7]; 
R{75}=[6,7]; 
R{76}=[6,7]; 
R{77}=[4,5]; 
R{78}=[4,5]; 
R{79}=[4,5]; 
R{80}=[4,5]; 
R{81}=[4,5]; 
R{82}=[10,11]; 
R{83}=[10,11]; 
R{84}=[10,11]; 
R{85}=[10,11]; 
R{86}=[10,11]; 
R{87}=[10,11]; 
R{88}=[10,11]; 
R{89}=[10,11]; 
R{90}=[10,11]; 
R{91}=[12,13]; 
R{92}=[12,13]; 
R{93}=[12,13]; 
R{94}=[12,13]; 
R{95}=[12,13]; 
R{96}=[12,13]; 
R{97}=[12,13]; 
R{98}=[12,13]; 
R{99}=[12,13]; 
R{100}=[12,13]; 
R{101}=[12,13]; 
R{102}=[12,13]; 
R{103}=[12,13]; 
R{104}=[12,13]; 
R{105}=[12,13]; 
R{106}=[12,13]; 
R{107}=[12,13]; 
R{108}=[12,13]; 
R{109}=[12,13]; 
R{110}=[12,13]; 
R{111}=[12,13]; 
R{112}=[16,17]; 
R{113}=[16,17]; 
R{114}=[16,17]; 
R{115}=[16,17]; 
R{116}=[16,17]; 
R{117}=[16,17]; 
R{118}=[16,17]; 
R{119}=[16,17]; 
R{120}=[16,17]; 
R{121}=[16,17]; 
R{122}=[16,17]; 
R{123}=[16,17]; 
R{124}=[16,17]; 
R{125}=[16,17]; 
R{126}=[16,17]; 
R{127}=[16,17]; 
R{128}=[16,17]; 
R{129}=[16,17]; 
R{130}=[16,17]; 
R{131}=[16,17]; 
R{132}=[16,17]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%% ordenacion procesamiento de trenes            %%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
[t_pla,I]=InitOrden(initia,t_pla,n_t); % inicializacion del orden del procesamiento
at=at(I); 
vt=vt.^(-1); 
vt=vt(I); 
Ntipotren=Ntipotren(I); 
Raux=R; 
Marcha=Marcha(I,:); 
for i=1:n_t 
   R{i}=Raux{I(i)}; 
end 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 %%%                 tiempo de viaje trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 for t1=1:n_t 
     for i_r=1:length(R{t1}) 
         D_t(t1,i_r)=TVr(R{t1}(i_r))*vt(t1)-at(t1); 
     end 
 end 
 n_s=0; % numero máximo de conflicto entre un par de trenes 
for t1=1:n_t-1 
    for t2=t1+1:n_t 
        for i_r1=1:length(R{t1}) 
            r1=R{t1}(i_r1); 
            for i_r2=1:length(R{t2}) 
                r2=R{t2}(i_r2); 
                if length(C{r1,r2})>0 
                C_t{i_r1,i_r2,t1,t2}=[C{r1,r2}(:,1:2)*vt(t1) C{r1,r2}(:,3:4)*vt(t2)]; 
                C_t{i_r2,i_r1,t2,t1}=[C{r2,r1}(:,1:2)*vt(t2) C{r2,r1}(:,3:4)*vt(t1)]; 
                n_s=max(n_s,size(C_t{i_r1,i_r2,t1,t2},1)); 
                end 
            end 
        end 
    end 
end 
%%%%%%%%%%%% FIN PROBLEMA4cS

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
    case 'Problem4a' % P R O B L E M   4 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%    RUTAS: MATRIZ DE CONFLICTOS Y TIEMPOS DE VIAJES 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
Mueve=@(A) [A(:,3) A(:,4) A(:,1) A(:,2)]; 
n_rutas=7 ;  
t_pla=[5.233 ; 5.417 ; 5.700 ; 5.900 ; 6.050 ; 6.250 ; 6.633 ; 6.883 ; 7.133 ; 7.350 ; 7.500 ; 7.850 ; 7.967 ; 8.350 ; 8.617 ; 8.850 ; 9.117 ; 9.350 ; 9.617 ; 9.850 ; 10.367 ; 10.850 ; 11.367 ; 11.850 ; 12.367 ; 12.817 ; 13.367 ; 13.850 ; 14.100 ; 14.367 ; 14.600 ; 14.850 ; 15.133 ; 15.350 ; 15.600 ; 15.850 ; 16.100 ; 16.350 ; 16.600 ; 16.850 ; 17.100 ; 17.350 ; 17.617 ; 17.850 ; 18.100 ; 18.350 ; 18.600 ; 18.850 ; 19.100 ; 19.350 ; 19.633 ; 19.850 ; 20.100 ; 20.350 ; 20.867 ; 21.367 ; 21.850 ; 22.367 ; 22.850 ; 23.350 ; 23.850 ; 5.217 ; 6.500 ; 6.717 ; 7.000 ; 7.700 ; 8.017 ; 8.233 ; 8.467 ; 8.733 ; 8.967 ; 9.200 ; 9.467 ; 9.700 ; 9.983 ; 10.200 ; 10.667 ; 11.183 ; 11.683 ; 12.183 ; 12.683 ; 13.183 ; 13.683 ; 13.967 ; 14.183 ; 14.483 ; 14.700 ; 14.967 ; 15.200 ; 15.483 ; 15.650 ; 16.217 ; 16.700 ; 17.200 ; 17.700 ; 18.200 ; 18.483 ; 18.700 ; 18.983 ; 19.200 ; 19.467 ; 19.683 ; 19.967 ; 20.200 ; 20.700 ; 21.200 ; 21.700 ; 22.200 ; 22.700 ; 23.200 ; 23.700 ; 5.983 ; 6.267 ; 6.517 ; 6.750 ; 6.983 ; 7.167 ; 7.367 ; 7.567 ; 7.750 ; 7.967 ; 8.117 ; 8.367 ; 8.533 ; 8.700 ; 8.967 ; 9.167 ; 9.367 ; 9.550 ; 9.750 ; 10.000 ; 10.267 ; 10.517 ; 10.983 ; 11.500 ; 11.983 ; 12.517 ; 12.983 ; 13.517 ; 13.983 ; 14.267 ; 14.500 ; 14.767 ; 14.983 ; 15.267 ; 15.500 ; 15.767 ; 15.983 ; 16.250 ; 16.517 ; 16.750 ; 16.983 ; 17.517 ; 17.750 ; 17.983 ; 18.267 ; 18.483 ; 18.750 ; 19.000 ; 19.250 ; 19.483 ; 19.750 ; 19.983 ; 20.250 ; 20.517 ; 20.750 ; 20.983 ; 21.267 ; 21.533 ; 22.017 ; 22.517 ; 22.983 ; 23.517 ; 0.050 ; 6.433 ; 6.650 ; 6.933 ; 7.633 ; 7.950 ; 8.167 ; 8.400 ; 8.667 ; 8.900 ; 9.133 ; 9.400 ; 9.633 ; 9.917 ; 10.133 ; 10.600 ; 11.117 ; 11.617 ; 12.117 ; 12.617 ; 13.117 ; 13.617 ; 13.900 ; 14.117 ; 14.417 ; 14.633 ; 14.900 ; 15.133 ; 15.417 ; 15.583 ; 16.150 ; 16.633 ; 17.133 ; 17.633 ; 18.133 ; 18.417 ; 18.633 ; 18.917 ; 19.133 ; 19.400 ; 19.617 ; 19.900 ; 20.133 ; 20.633 ; 21.133 ; 21.633 ; 22.133 ; 22.633 ; 23.133 ; 23.633 ; ]; 
t_pla=SimulacionRetraso(t_pla,version);
at=[5.321 ; 5.504 ; 5.788 ; 5.988 ; 6.138 ; 6.338 ; 6.721 ; 6.971 ; 7.221 ; 7.438 ; 7.588 ; 7.938 ; 8.054 ; 8.438 ; 8.704 ; 8.938 ; 9.204 ; 9.438 ; 9.704 ; 9.938 ; 10.454 ; 10.938 ; 11.454 ; 11.938 ; 12.454 ; 12.904 ; 13.454 ; 13.938 ; 14.188 ; 14.454 ; 14.688 ; 14.938 ; 15.221 ; 15.438 ; 15.688 ; 15.938 ; 16.187 ; 16.438 ; 16.687 ; 16.938 ; 17.187 ; 17.438 ; 17.704 ; 17.938 ; 18.187 ; 18.438 ; 18.687 ; 18.938 ; 19.187 ; 19.438 ; 19.721 ; 19.938 ; 20.187 ; 20.438 ; 20.954 ; 21.454 ; 21.938 ; 22.454 ; 22.938 ; 23.438 ; 23.938 ; 5.304 ; 6.588 ; 6.804 ; 7.088 ; 7.788 ; 8.104 ; 8.321 ; 8.554 ; 8.821 ; 9.054 ; 9.287 ; 9.554 ; 9.787 ; 10.071 ; 10.287 ; 10.754 ; 11.271 ; 11.771 ; 12.271 ; 12.771 ; 13.271 ; 13.771 ; 14.054 ; 14.271 ; 14.571 ; 14.787 ; 15.054 ; 15.287 ; 15.571 ; 15.738 ; 16.304 ; 16.788 ; 17.288 ; 17.788 ; 18.288 ; 18.571 ; 18.788 ; 19.071 ; 19.288 ; 19.554 ; 19.771 ; 20.054 ; 20.288 ; 20.788 ; 21.288 ; 21.788 ; 22.288 ; 22.788 ; 23.288 ; 23.788 ; 6.071 ; 6.354 ; 6.604 ; 6.838 ; 7.071 ; 7.254 ; 7.454 ; 7.654 ; 7.838 ; 8.054 ; 8.204 ; 8.454 ; 8.621 ; 8.787 ; 9.054 ; 9.254 ; 9.454 ; 9.638 ; 9.837 ; 10.088 ; 10.354 ; 10.604 ; 11.071 ; 11.588 ; 12.071 ; 12.604 ; 13.071 ; 13.604 ; 14.071 ; 14.354 ; 14.588 ; 14.854 ; 15.071 ; 15.354 ; 15.588 ; 15.854 ; 16.071 ; 16.337 ; 16.604 ; 16.837 ; 17.071 ; 17.604 ; 17.837 ; 18.071 ; 18.354 ; 18.571 ; 18.837 ; 19.087 ; 19.337 ; 19.571 ; 19.837 ; 20.071 ; 20.337 ; 20.604 ; 20.837 ; 21.071 ; 21.354 ; 21.621 ; 22.104 ; 22.604 ; 23.071 ; 23.604 ; 0.138 ; 6.521 ; 6.737 ; 7.021 ; 7.721 ; 8.037 ; 8.254 ; 8.488 ; 8.754 ; 8.987 ; 9.221 ; 9.488 ; 9.721 ; 10.004 ; 10.221 ; 10.688 ; 11.204 ; 11.704 ; 12.204 ; 12.704 ; 13.204 ; 13.704 ; 13.987 ; 14.204 ; 14.504 ; 14.721 ; 14.987 ; 15.221 ; 15.504 ; 15.671 ; 16.237 ; 16.721 ; 17.221 ; 17.721 ; 18.221 ; 18.504 ; 18.721 ; 19.004 ; 19.221 ; 19.487 ; 19.704 ; 19.987 ; 20.221 ; 20.721 ; 21.221 ; 21.721 ; 22.221 ; 22.721 ; 23.221 ; 23.721 ; ]; 
vt=[40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; ]; 
n_t=length(t_pla);  % número de trenes 
Ntipotren=[1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; ]; 
tipotren={'C2+','','C2-','','C7+','','C7-','','C5+','','C5-','','C4+','','C4-','','C3+','','C3-'}; 
C{1,1}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
]; 
C{1,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,3}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{3,4}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,5}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,6}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,7}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{4,4}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{4,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,6}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{7,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{1,1}=Mueve(C{1,1}); 
C{2,1}=Mueve(C{1,2}); 
C{3,1}=Mueve(C{1,3}); 
C{4,1}=Mueve(C{1,4}); 
C{5,1}=Mueve(C{1,5}); 
C{6,1}=Mueve(C{1,6}); 
C{7,1}=Mueve(C{1,7}); 
C{2,2}=Mueve(C{2,2}); 
C{3,2}=Mueve(C{2,3}); 
C{4,2}=Mueve(C{2,4}); 
C{5,2}=Mueve(C{2,5}); 
C{6,2}=Mueve(C{2,6}); 
C{7,2}=Mueve(C{2,7}); 
C{3,3}=Mueve(C{3,3}); 
C{4,3}=Mueve(C{3,4}); 
C{5,3}=Mueve(C{3,5}); 
C{6,3}=Mueve(C{3,6}); 
C{7,3}=Mueve(C{3,7}); 
C{4,4}=Mueve(C{4,4}); 
C{5,4}=Mueve(C{4,5}); 
C{6,4}=Mueve(C{4,6}); 
C{7,4}=Mueve(C{4,7}); 
C{5,5}=Mueve(C{5,5}); 
C{6,5}=Mueve(C{5,6}); 
C{7,5}=Mueve(C{5,7}); 
C{6,6}=Mueve(C{6,6}); 
C{7,6}=Mueve(C{6,7}); 
C{7,7}=Mueve(C{7,7}); 
Marcha=zeros(n_t,n_rutas); 
Marcha(1:111,[1,2,3])=+1; 
Marcha(112:223,[4,5,6,7])=-1; 
TVr=[3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%  asignacion rutas a trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
R{1}=[3]; 
R{2}=[3]; 
R{3}=[3]; 
R{4}=[3]; 
R{5}=[3]; 
R{6}=[3]; 
R{7}=[3]; 
R{8}=[3]; 
R{9}=[3]; 
R{10}=[3]; 
R{11}=[3]; 
R{12}=[3]; 
R{13}=[3]; 
R{14}=[3]; 
R{15}=[3]; 
R{16}=[3]; 
R{17}=[3]; 
R{18}=[3]; 
R{19}=[3]; 
R{20}=[3]; 
R{21}=[3]; 
R{22}=[3]; 
R{23}=[3]; 
R{24}=[3]; 
R{25}=[3]; 
R{26}=[3]; 
R{27}=[3]; 
R{28}=[3]; 
R{29}=[3]; 
R{30}=[3]; 
R{31}=[3]; 
R{32}=[3]; 
R{33}=[3]; 
R{34}=[3]; 
R{35}=[3]; 
R{36}=[3]; 
R{37}=[3]; 
R{38}=[3]; 
R{39}=[3]; 
R{40}=[3]; 
R{41}=[3]; 
R{42}=[3]; 
R{43}=[3]; 
R{44}=[3]; 
R{45}=[3]; 
R{46}=[3]; 
R{47}=[3]; 
R{48}=[3]; 
R{49}=[3]; 
R{50}=[3]; 
R{51}=[3]; 
R{52}=[3]; 
R{53}=[3]; 
R{54}=[3]; 
R{55}=[3]; 
R{56}=[3]; 
R{57}=[3]; 
R{58}=[3]; 
R{59}=[3]; 
R{60}=[3]; 
R{61}=[3]; 
R{62}=[1,2]; 
R{63}=[1,2]; 
R{64}=[1,2]; 
R{65}=[1,2]; 
R{66}=[1,2]; 
R{67}=[1,2]; 
R{68}=[1,2]; 
R{69}=[1,2]; 
R{70}=[1,2]; 
R{71}=[1,2]; 
R{72}=[1,2]; 
R{73}=[1,2]; 
R{74}=[1,2]; 
R{75}=[1,2]; 
R{76}=[1,2]; 
R{77}=[1,2]; 
R{78}=[1,2]; 
R{79}=[1,2]; 
R{80}=[1,2]; 
R{81}=[1,2]; 
R{82}=[1,2]; 
R{83}=[1,2]; 
R{84}=[1,2]; 
R{85}=[1,2]; 
R{86}=[1,2]; 
R{87}=[1,2]; 
R{88}=[1,2]; 
R{89}=[1,2]; 
R{90}=[1,2]; 
R{91}=[1,2]; 
R{92}=[1,2]; 
R{93}=[1,2]; 
R{94}=[1,2]; 
R{95}=[1,2]; 
R{96}=[1,2]; 
R{97}=[1,2]; 
R{98}=[1,2]; 
R{99}=[1,2]; 
R{100}=[1,2]; 
R{101}=[1,2]; 
R{102}=[1,2]; 
R{103}=[1,2]; 
R{104}=[1,2]; 
R{105}=[1,2]; 
R{106}=[1,2]; 
R{107}=[1,2]; 
R{108}=[1,2]; 
R{109}=[1,2]; 
R{110}=[1,2]; 
R{111}=[1,2]; 
R{112}=[6,7]; 
R{113}=[6,7]; 
R{114}=[6,7]; 
R{115}=[6,7]; 
R{116}=[6,7]; 
R{117}=[6,7]; 
R{118}=[6,7]; 
R{119}=[6,7]; 
R{120}=[6,7]; 
R{121}=[6,7]; 
R{122}=[6,7]; 
R{123}=[6,7]; 
R{124}=[6,7]; 
R{125}=[6,7]; 
R{126}=[6,7]; 
R{127}=[6,7]; 
R{128}=[6,7]; 
R{129}=[6,7]; 
R{130}=[6,7]; 
R{131}=[6,7]; 
R{132}=[6,7]; 
R{133}=[6,7]; 
R{134}=[6,7]; 
R{135}=[6,7]; 
R{136}=[6,7]; 
R{137}=[6,7]; 
R{138}=[6,7]; 
R{139}=[6,7]; 
R{140}=[6,7]; 
R{141}=[6,7]; 
R{142}=[6,7]; 
R{143}=[6,7]; 
R{144}=[6,7]; 
R{145}=[6,7]; 
R{146}=[6,7]; 
R{147}=[6,7]; 
R{148}=[6,7]; 
R{149}=[6,7]; 
R{150}=[6,7]; 
R{151}=[6,7]; 
R{152}=[6,7]; 
R{153}=[6,7]; 
R{154}=[6,7]; 
R{155}=[6,7]; 
R{156}=[6,7]; 
R{157}=[6,7]; 
R{158}=[6,7]; 
R{159}=[6,7]; 
R{160}=[6,7]; 
R{161}=[6,7]; 
R{162}=[6,7]; 
R{163}=[6,7]; 
R{164}=[6,7]; 
R{165}=[6,7]; 
R{166}=[6,7]; 
R{167}=[6,7]; 
R{168}=[6,7]; 
R{169}=[6,7]; 
R{170}=[6,7]; 
R{171}=[6,7]; 
R{172}=[6,7]; 
R{173}=[6,7]; 
R{174}=[6,7]; 
R{175}=[4,5]; 
R{176}=[4,5]; 
R{177}=[4,5]; 
R{178}=[4,5]; 
R{179}=[4,5]; 
R{180}=[4,5]; 
R{181}=[4,5]; 
R{182}=[4,5]; 
R{183}=[4,5]; 
R{184}=[4,5]; 
R{185}=[4,5]; 
R{186}=[4,5]; 
R{187}=[4,5]; 
R{188}=[4,5]; 
R{189}=[4,5]; 
R{190}=[4,5]; 
R{191}=[4,5]; 
R{192}=[4,5]; 
R{193}=[4,5]; 
R{194}=[4,5]; 
R{195}=[4,5]; 
R{196}=[4,5]; 
R{197}=[4,5]; 
R{198}=[4,5]; 
R{199}=[4,5]; 
R{200}=[4,5]; 
R{201}=[4,5]; 
R{202}=[4,5]; 
R{203}=[4,5]; 
R{204}=[4,5]; 
R{205}=[4,5]; 
R{206}=[4,5]; 
R{207}=[4,5]; 
R{208}=[4,5]; 
R{209}=[4,5]; 
R{210}=[4,5]; 
R{211}=[4,5]; 
R{212}=[4,5]; 
R{213}=[4,5]; 
R{214}=[4,5]; 
R{215}=[4,5]; 
R{216}=[4,5]; 
R{217}=[4,5]; 
R{218}=[4,5]; 
R{219}=[4,5]; 
R{220}=[4,5]; 
R{221}=[4,5]; 
R{222}=[4,5]; 
R{223}=[4,5]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%% ordenacion procesamiento de trenes            %%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
[t_pla,I]=InitOrden(initia,t_pla,n_t); % inicializacion del orden del procesamiento
at=at(I); 
vt=vt.^(-1); 
vt=vt(I); 
Ntipotren=Ntipotren(I); 
Raux=R; 
Marcha=Marcha(I,:); 
for i=1:n_t 
   R{i}=Raux{I(i)}; 
end 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 %%%                 tiempo de viaje trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 for t1=1:n_t 
     for i_r=1:length(R{t1}) 
         D_t(t1,i_r)=TVr(R{t1}(i_r))*vt(t1)-at(t1); 
     end 
 end 
 n_s=0; % numero máximo de conflicto entre un par de trenes 
for t1=1:n_t-1 
    for t2=t1+1:n_t 
        for i_r1=1:length(R{t1}) 
            r1=R{t1}(i_r1); 
            for i_r2=1:length(R{t2}) 
                r2=R{t2}(i_r2); 
                if length(C{r1,r2})>0 
                C_t{i_r1,i_r2,t1,t2}=[C{r1,r2}(:,1:2)*vt(t1) C{r1,r2}(:,3:4)*vt(t2)]; 
                C_t{i_r2,i_r1,t2,t1}=[C{r2,r1}(:,1:2)*vt(t2) C{r2,r1}(:,3:4)*vt(t1)]; 
                n_s=max(n_s,size(C_t{i_r1,i_r2,t1,t2},1)); 
                end 
            end 
        end 
    end 
end 
%%%%%%%%%%% FIN PROBLEMA4a
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
    case 'Problem4b' % P R O B L E M   4 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%    RUTAS: MATRIZ DE CONFLICTOS Y TIEMPOS DE VIAJES 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
Mueve=@(A) [A(:,3) A(:,4) A(:,1) A(:,2)]; 
n_rutas=13 ;  
t_pla=[5.233 ; 5.417 ; 5.700 ; 5.900 ; 6.050 ; 6.250 ; 6.633 ; 6.883 ; 7.133 ; 7.350 ; 7.500 ; 7.850 ; 7.967 ; 8.350 ; 8.617 ; 8.850 ; 9.117 ; 9.350 ; 9.617 ; 9.850 ; 10.367 ; 10.850 ; 11.367 ; 11.850 ; 12.367 ; 12.817 ; 13.367 ; 13.850 ; 14.100 ; 14.367 ; 14.600 ; 14.850 ; 15.133 ; 15.350 ; 15.600 ; 15.850 ; 16.100 ; 16.350 ; 16.600 ; 16.850 ; 17.100 ; 17.350 ; 17.617 ; 17.850 ; 18.100 ; 18.350 ; 18.600 ; 18.850 ; 19.100 ; 19.350 ; 19.633 ; 19.850 ; 20.100 ; 20.350 ; 20.867 ; 21.367 ; 21.850 ; 22.367 ; 22.850 ; 23.350 ; 23.850 ; 5.217 ; 6.500 ; 6.717 ; 7.000 ; 7.700 ; 8.017 ; 8.233 ; 8.467 ; 8.733 ; 8.967 ; 9.200 ; 9.467 ; 9.700 ; 9.983 ; 10.200 ; 10.667 ; 11.183 ; 11.683 ; 12.183 ; 12.683 ; 13.183 ; 13.683 ; 13.967 ; 14.183 ; 14.483 ; 14.700 ; 14.967 ; 15.200 ; 15.483 ; 15.650 ; 16.217 ; 16.700 ; 17.200 ; 17.700 ; 18.200 ; 18.483 ; 18.700 ; 18.983 ; 19.200 ; 19.467 ; 19.683 ; 19.967 ; 20.200 ; 20.700 ; 21.200 ; 21.700 ; 22.200 ; 22.700 ; 23.200 ; 23.700 ; 4.950 ; 5.400 ; 5.600 ; 5.750 ; 5.800 ; 5.950 ; 6.000 ; 6.200 ; 6.300 ; 6.400 ; 6.517 ; 6.633 ; 6.750 ; 6.800 ; 6.900 ; 7.000 ; 7.100 ; 7.200 ; 7.333 ; 7.450 ; 7.550 ; 7.600 ; 7.700 ; 7.783 ; 7.900 ; 8.000 ; 8.100 ; 8.200 ; 8.283 ; 8.400 ; 8.500 ; 8.583 ; 8.700 ; 8.800 ; 8.917 ; 9.000 ; 9.100 ; 9.200 ; 9.300 ; 9.400 ; 9.500 ; 9.617 ; 9.733 ; 9.833 ; 9.950 ; 10.050 ; 10.200 ; 10.300 ; 10.533 ; 10.683 ; 10.833 ; 11.017 ; 11.183 ; 11.350 ; 11.517 ; 11.683 ; 11.850 ; 12.017 ; 12.183 ; 12.350 ; 12.517 ; 12.650 ; 12.850 ; 13.017 ; 13.183 ; 13.333 ; 13.517 ; 13.683 ; 13.850 ; 14.000 ; 14.183 ; 14.400 ; 14.533 ; 14.683 ; 14.783 ; 14.933 ; 15.050 ; 15.183 ; 15.283 ; 15.400 ; 15.533 ; 15.683 ; 15.833 ; 16.017 ; 16.183 ; 16.367 ; 16.517 ; 16.683 ; 16.850 ; 17.017 ; 17.183 ; 17.350 ; 17.517 ; 17.667 ; 17.800 ; 17.933 ; 18.050 ; 18.183 ; 18.300 ; 18.400 ; 18.533 ; 18.683 ; 18.833 ; 18.933 ; 19.050 ; 19.183 ; 19.267 ; 19.400 ; 19.533 ; 19.683 ; 19.800 ; 19.900 ; 20.050 ; 20.200 ; 20.333 ; 20.433 ; 20.533 ; 20.650 ; 20.817 ; 20.933 ; 21.050 ; 21.200 ; 21.283 ; 21.417 ; 21.550 ; 21.700 ; 21.833 ; 22.033 ; 22.183 ; 22.383 ; 22.517 ; 22.683 ; 22.833 ; 22.933 ; 23.167 ; 23.383 ; 5.983 ; 6.267 ; 6.517 ; 6.750 ; 6.983 ; 7.167 ; 7.367 ; 7.567 ; 7.750 ; 7.967 ; 8.117 ; 8.367 ; 8.533 ; 8.700 ; 8.967 ; 9.167 ; 9.367 ; 9.550 ; 9.750 ; 10.000 ; 10.267 ; 10.517 ; 10.983 ; 11.500 ; 11.983 ; 12.517 ; 12.983 ; 13.517 ; 13.983 ; 14.267 ; 14.500 ; 14.767 ; 14.983 ; 15.267 ; 15.500 ; 15.767 ; 15.983 ; 16.250 ; 16.517 ; 16.750 ; 16.983 ; 17.517 ; 17.750 ; 17.983 ; 18.267 ; 18.483 ; 18.750 ; 19.000 ; 19.250 ; 19.483 ; 19.750 ; 19.983 ; 20.250 ; 20.517 ; 20.750 ; 20.983 ; 21.267 ; 21.533 ; 22.017 ; 22.517 ; 22.983 ; 23.517 ; 0.050 ; 6.433 ; 6.650 ; 6.933 ; 7.633 ; 7.950 ; 8.167 ; 8.400 ; 8.667 ; 8.900 ; 9.133 ; 9.400 ; 9.633 ; 9.917 ; 10.133 ; 10.600 ; 11.117 ; 11.617 ; 12.117 ; 12.617 ; 13.117 ; 13.617 ; 13.900 ; 14.117 ; 14.417 ; 14.633 ; 14.900 ; 15.133 ; 15.417 ; 15.583 ; 16.150 ; 16.633 ; 17.133 ; 17.633 ; 18.133 ; 18.417 ; 18.633 ; 18.917 ; 19.133 ; 19.400 ; 19.617 ; 19.900 ; 20.133 ; 20.633 ; 21.133 ; 21.633 ; 22.133 ; 22.633 ; 23.133 ; 23.633 ; 6.033 ; 6.333 ; 6.567 ; 6.833 ; 7.133 ; 7.367 ; 7.533 ; 7.633 ; 7.817 ; 8.133 ; 8.333 ; 8.433 ; 8.617 ; 8.833 ; 9.033 ; 9.333 ; 9.667 ; 10.083 ; 10.583 ; 11.050 ; 11.567 ; 12.083 ; 12.567 ; 13.067 ; 13.550 ; 13.933 ; 14.267 ; 14.567 ; 14.817 ; 15.083 ; 15.333 ; 15.583 ; 15.917 ; 16.250 ; 16.567 ; 16.900 ; 17.233 ; 17.733 ; 18.100 ; 18.433 ; 18.767 ; 18.983 ; 19.300 ; 19.717 ; 19.983 ; 20.233 ; 20.583 ; 20.967 ; 21.317 ; 21.633 ; 21.900 ; 22.267 ; 22.583 ; 22.867 ; 23.233 ; 23.550 ; 23.867 ; 5.583 ; 5.783 ; 5.983 ; 6.183 ; 6.283 ; 6.383 ; 6.483 ; 6.617 ; 6.733 ; 6.783 ; 6.883 ; 6.983 ; 7.083 ; 7.183 ; 7.317 ; 7.433 ; 7.583 ; 7.683 ; 7.767 ; 7.883 ; 7.983 ; 8.083 ; 8.183 ; 8.267 ; 8.383 ; 8.483 ; 8.567 ; 8.683 ; 8.783 ; 8.900 ; 8.983 ; 9.083 ; 9.183 ; 9.283 ; 9.383 ; 9.483 ; 9.600 ; 9.717 ; 9.817 ; 9.933 ; 10.033 ; 10.183 ; 10.283 ; 10.417 ; 10.517 ; 10.667 ; 10.817 ; 11.000 ; 11.167 ; 11.333 ; 11.500 ; 11.667 ; 11.833 ; 12.000 ; 12.167 ; 12.333 ; 12.500 ; 12.633 ; 12.833 ; 13.000 ; 13.167 ; 13.317 ; 13.500 ; 13.667 ; 13.833 ; 13.983 ; 14.167 ; 14.383 ; 14.517 ; 14.667 ; 14.767 ; 14.917 ; 15.033 ; 15.167 ; 15.267 ; 15.383 ; 15.517 ; 15.667 ; 15.817 ; 16.000 ; 16.167 ; 16.350 ; 16.500 ; 16.667 ; 16.833 ; 17.000 ; 17.167 ; 17.333 ; 17.500 ; 17.650 ; 17.783 ; 17.917 ; 18.033 ; 18.167 ; 18.283 ; 18.383 ; 18.517 ; 18.667 ; 18.817 ; 18.917 ; 19.033 ; 19.167 ; 19.250 ; 19.383 ; 19.517 ; 19.667 ; 19.783 ; 19.883 ; 20.033 ; 20.183 ; 20.317 ; 20.417 ; 20.517 ; 20.633 ; 20.800 ; 20.917 ; 21.033 ; 21.183 ; 21.267 ; 21.400 ; 21.533 ; 21.683 ; 21.817 ; 22.017 ; 22.167 ; 22.367 ; 22.500 ; 22.667 ; 22.817 ; 22.917 ; 23.150 ; 23.367 ; 23.650 ; 23.917 ; ]; 
t_pla=SimulacionRetraso(t_pla,version);
at=[5.321 ; 5.504 ; 5.788 ; 5.988 ; 6.138 ; 6.338 ; 6.721 ; 6.971 ; 7.221 ; 7.438 ; 7.588 ; 7.938 ; 8.054 ; 8.438 ; 8.704 ; 8.938 ; 9.204 ; 9.438 ; 9.704 ; 9.938 ; 10.454 ; 10.938 ; 11.454 ; 11.938 ; 12.454 ; 12.904 ; 13.454 ; 13.938 ; 14.188 ; 14.454 ; 14.688 ; 14.938 ; 15.221 ; 15.438 ; 15.688 ; 15.938 ; 16.187 ; 16.438 ; 16.687 ; 16.938 ; 17.187 ; 17.438 ; 17.704 ; 17.938 ; 18.187 ; 18.438 ; 18.687 ; 18.938 ; 19.187 ; 19.438 ; 19.721 ; 19.938 ; 20.187 ; 20.438 ; 20.954 ; 21.454 ; 21.938 ; 22.454 ; 22.938 ; 23.438 ; 23.938 ; 5.304 ; 6.588 ; 6.804 ; 7.088 ; 7.788 ; 8.104 ; 8.321 ; 8.554 ; 8.821 ; 9.054 ; 9.287 ; 9.554 ; 9.787 ; 10.071 ; 10.287 ; 10.754 ; 11.271 ; 11.771 ; 12.271 ; 12.771 ; 13.271 ; 13.771 ; 14.054 ; 14.271 ; 14.571 ; 14.787 ; 15.054 ; 15.287 ; 15.571 ; 15.738 ; 16.304 ; 16.788 ; 17.288 ; 17.788 ; 18.288 ; 18.571 ; 18.788 ; 19.071 ; 19.288 ; 19.554 ; 19.771 ; 20.054 ; 20.288 ; 20.788 ; 21.288 ; 21.788 ; 22.288 ; 22.788 ; 23.288 ; 23.788 ; 5.038 ; 5.488 ; 5.688 ; 5.838 ; 5.888 ; 6.038 ; 6.088 ; 6.288 ; 6.388 ; 6.488 ; 6.604 ; 6.721 ; 6.838 ; 6.888 ; 6.988 ; 7.088 ; 7.188 ; 7.288 ; 7.421 ; 7.537 ; 7.638 ; 7.688 ; 7.788 ; 7.871 ; 7.988 ; 8.088 ; 8.188 ; 8.287 ; 8.371 ; 8.488 ; 8.588 ; 8.671 ; 8.787 ; 8.888 ; 9.004 ; 9.088 ; 9.188 ; 9.287 ; 9.387 ; 9.488 ; 9.588 ; 9.704 ; 9.821 ; 9.921 ; 10.038 ; 10.137 ; 10.287 ; 10.387 ; 10.621 ; 10.771 ; 10.921 ; 11.104 ; 11.271 ; 11.438 ; 11.604 ; 11.771 ; 11.938 ; 12.104 ; 12.271 ; 12.438 ; 12.604 ; 12.738 ; 12.938 ; 13.104 ; 13.271 ; 13.421 ; 13.604 ; 13.771 ; 13.938 ; 14.088 ; 14.271 ; 14.488 ; 14.621 ; 14.771 ; 14.871 ; 15.021 ; 15.137 ; 15.271 ; 15.371 ; 15.488 ; 15.621 ; 15.771 ; 15.921 ; 16.104 ; 16.271 ; 16.454 ; 16.604 ; 16.771 ; 16.938 ; 17.104 ; 17.271 ; 17.438 ; 17.604 ; 17.754 ; 17.887 ; 18.021 ; 18.137 ; 18.271 ; 18.387 ; 18.487 ; 18.621 ; 18.771 ; 18.921 ; 19.021 ; 19.137 ; 19.271 ; 19.354 ; 19.487 ; 19.621 ; 19.771 ; 19.887 ; 19.987 ; 20.137 ; 20.288 ; 20.421 ; 20.521 ; 20.621 ; 20.738 ; 20.904 ; 21.021 ; 21.137 ; 21.288 ; 21.371 ; 21.504 ; 21.637 ; 21.788 ; 21.921 ; 22.121 ; 22.271 ; 22.471 ; 22.604 ; 22.771 ; 22.921 ; 23.021 ; 23.254 ; 23.471 ; 6.071 ; 6.354 ; 6.604 ; 6.838 ; 7.071 ; 7.254 ; 7.454 ; 7.654 ; 7.838 ; 8.054 ; 8.204 ; 8.454 ; 8.621 ; 8.787 ; 9.054 ; 9.254 ; 9.454 ; 9.638 ; 9.837 ; 10.088 ; 10.354 ; 10.604 ; 11.071 ; 11.588 ; 12.071 ; 12.604 ; 13.071 ; 13.604 ; 14.071 ; 14.354 ; 14.588 ; 14.854 ; 15.071 ; 15.354 ; 15.588 ; 15.854 ; 16.071 ; 16.337 ; 16.604 ; 16.837 ; 17.071 ; 17.604 ; 17.837 ; 18.071 ; 18.354 ; 18.571 ; 18.837 ; 19.087 ; 19.337 ; 19.571 ; 19.837 ; 20.071 ; 20.337 ; 20.604 ; 20.837 ; 21.071 ; 21.354 ; 21.621 ; 22.104 ; 22.604 ; 23.071 ; 23.604 ; 0.138 ; 6.521 ; 6.737 ; 7.021 ; 7.721 ; 8.037 ; 8.254 ; 8.488 ; 8.754 ; 8.987 ; 9.221 ; 9.488 ; 9.721 ; 10.004 ; 10.221 ; 10.688 ; 11.204 ; 11.704 ; 12.204 ; 12.704 ; 13.204 ; 13.704 ; 13.987 ; 14.204 ; 14.504 ; 14.721 ; 14.987 ; 15.221 ; 15.504 ; 15.671 ; 16.237 ; 16.721 ; 17.221 ; 17.721 ; 18.221 ; 18.504 ; 18.721 ; 19.004 ; 19.221 ; 19.487 ; 19.704 ; 19.987 ; 20.221 ; 20.721 ; 21.221 ; 21.721 ; 22.221 ; 22.721 ; 23.221 ; 23.721 ; 6.121 ; 6.421 ; 6.654 ; 6.921 ; 7.221 ; 7.454 ; 7.621 ; 7.721 ; 7.904 ; 8.221 ; 8.421 ; 8.521 ; 8.704 ; 8.921 ; 9.121 ; 9.421 ; 9.754 ; 10.171 ; 10.671 ; 11.137 ; 11.654 ; 12.171 ; 12.654 ; 13.154 ; 13.638 ; 14.021 ; 14.354 ; 14.654 ; 14.904 ; 15.171 ; 15.421 ; 15.671 ; 16.004 ; 16.337 ; 16.654 ; 16.987 ; 17.321 ; 17.821 ; 18.187 ; 18.521 ; 18.854 ; 19.071 ; 19.387 ; 19.804 ; 20.071 ; 20.321 ; 20.671 ; 21.054 ; 21.404 ; 21.721 ; 21.987 ; 22.354 ; 22.671 ; 22.954 ; 23.321 ; 23.637 ; 23.954 ; 5.671 ; 5.871 ; 6.071 ; 6.271 ; 6.371 ; 6.471 ; 6.571 ; 6.704 ; 6.821 ; 6.871 ; 6.971 ; 7.071 ; 7.171 ; 7.271 ; 7.404 ; 7.521 ; 7.671 ; 7.771 ; 7.854 ; 7.971 ; 8.071 ; 8.171 ; 8.271 ; 8.354 ; 8.471 ; 8.571 ; 8.654 ; 8.771 ; 8.871 ; 8.987 ; 9.071 ; 9.171 ; 9.271 ; 9.371 ; 9.471 ; 9.571 ; 9.688 ; 9.804 ; 9.904 ; 10.021 ; 10.121 ; 10.271 ; 10.371 ; 10.504 ; 10.604 ; 10.754 ; 10.904 ; 11.088 ; 11.254 ; 11.421 ; 11.588 ; 11.754 ; 11.921 ; 12.088 ; 12.254 ; 12.421 ; 12.588 ; 12.721 ; 12.921 ; 13.088 ; 13.254 ; 13.404 ; 13.588 ; 13.754 ; 13.921 ; 14.071 ; 14.254 ; 14.471 ; 14.604 ; 14.754 ; 14.854 ; 15.004 ; 15.121 ; 15.254 ; 15.354 ; 15.471 ; 15.604 ; 15.754 ; 15.904 ; 16.087 ; 16.254 ; 16.438 ; 16.587 ; 16.754 ; 16.921 ; 17.087 ; 17.254 ; 17.421 ; 17.587 ; 17.738 ; 17.871 ; 18.004 ; 18.121 ; 18.254 ; 18.371 ; 18.471 ; 18.604 ; 18.754 ; 18.904 ; 19.004 ; 19.121 ; 19.254 ; 19.337 ; 19.471 ; 19.604 ; 19.754 ; 19.871 ; 19.971 ; 20.121 ; 20.271 ; 20.404 ; 20.504 ; 20.604 ; 20.721 ; 20.887 ; 21.004 ; 21.121 ; 21.271 ; 21.354 ; 21.487 ; 21.621 ; 21.771 ; 21.904 ; 22.104 ; 22.254 ; 22.454 ; 22.587 ; 22.754 ; 22.904 ; 23.004 ; 23.237 ; 23.454 ; 23.738 ; 24.004 ; ]; 
vt=[40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; ]; 
n_t=length(t_pla);  % número de trenes 
Ntipotren=[1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; ]; 
tipotren={'C2+','','C2-','','C7+','','C7-','','C5+','','C5-','','C4+','','C4-','','C3+','','C3-'}; 
C{1,1}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
]; 
C{1,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,3}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{3,4}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,5}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,6}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,7}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{4,4}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{4,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,6}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{7,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{8,8}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{8,9}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{9,9}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{9,10}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    1.250 	    3.450 	    0.250 	    2.450  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{9,11}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{9,12}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{9,13}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    1.250 	    3.450 	    0.250 	    2.450  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{10,10}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{10,11}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{10,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{10,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,11}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{12,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{12,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{13,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{1,1}=Mueve(C{1,1}); 
C{2,1}=Mueve(C{1,2}); 
C{3,1}=Mueve(C{1,3}); 
C{4,1}=Mueve(C{1,4}); 
C{5,1}=Mueve(C{1,5}); 
C{6,1}=Mueve(C{1,6}); 
C{7,1}=Mueve(C{1,7}); 
C{2,2}=Mueve(C{2,2}); 
C{3,2}=Mueve(C{2,3}); 
C{4,2}=Mueve(C{2,4}); 
C{5,2}=Mueve(C{2,5}); 
C{6,2}=Mueve(C{2,6}); 
C{7,2}=Mueve(C{2,7}); 
C{3,3}=Mueve(C{3,3}); 
C{4,3}=Mueve(C{3,4}); 
C{5,3}=Mueve(C{3,5}); 
C{6,3}=Mueve(C{3,6}); 
C{7,3}=Mueve(C{3,7}); 
C{4,4}=Mueve(C{4,4}); 
C{5,4}=Mueve(C{4,5}); 
C{6,4}=Mueve(C{4,6}); 
C{7,4}=Mueve(C{4,7}); 
C{5,5}=Mueve(C{5,5}); 
C{6,5}=Mueve(C{5,6}); 
C{7,5}=Mueve(C{5,7}); 
C{6,6}=Mueve(C{6,6}); 
C{7,6}=Mueve(C{6,7}); 
C{7,7}=Mueve(C{7,7}); 
C{8,8}=Mueve(C{8,8}); 
C{9,8}=Mueve(C{8,9}); 
C{9,9}=Mueve(C{9,9}); 
C{10,9}=Mueve(C{9,10}); 
C{11,9}=Mueve(C{9,11}); 
C{12,9}=Mueve(C{9,12}); 
C{13,9}=Mueve(C{9,13}); 
C{10,10}=Mueve(C{10,10}); 
C{11,10}=Mueve(C{10,11}); 
C{12,10}=Mueve(C{10,12}); 
C{13,10}=Mueve(C{10,13}); 
C{11,11}=Mueve(C{11,11}); 
C{12,11}=Mueve(C{11,12}); 
C{13,11}=Mueve(C{11,13}); 
C{12,12}=Mueve(C{12,12}); 
C{13,12}=Mueve(C{12,13}); 
C{13,13}=Mueve(C{13,13}); 
Marcha=zeros(n_t,n_rutas); 
Marcha(1:247,[1,2,3,8,9])=+1; 
Marcha(248:550,[4,5,6,7,10,11,12,13])=-1; 
TVr=[3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%  asignacion rutas a trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
R{1}=[3]; 
R{2}=[3]; 
R{3}=[3]; 
R{4}=[3]; 
R{5}=[3]; 
R{6}=[3]; 
R{7}=[3]; 
R{8}=[3]; 
R{9}=[3]; 
R{10}=[3]; 
R{11}=[3]; 
R{12}=[3]; 
R{13}=[3]; 
R{14}=[3]; 
R{15}=[3]; 
R{16}=[3]; 
R{17}=[3]; 
R{18}=[3]; 
R{19}=[3]; 
R{20}=[3]; 
R{21}=[3]; 
R{22}=[3]; 
R{23}=[3]; 
R{24}=[3]; 
R{25}=[3]; 
R{26}=[3]; 
R{27}=[3]; 
R{28}=[3]; 
R{29}=[3]; 
R{30}=[3]; 
R{31}=[3]; 
R{32}=[3]; 
R{33}=[3]; 
R{34}=[3]; 
R{35}=[3]; 
R{36}=[3]; 
R{37}=[3]; 
R{38}=[3]; 
R{39}=[3]; 
R{40}=[3]; 
R{41}=[3]; 
R{42}=[3]; 
R{43}=[3]; 
R{44}=[3]; 
R{45}=[3]; 
R{46}=[3]; 
R{47}=[3]; 
R{48}=[3]; 
R{49}=[3]; 
R{50}=[3]; 
R{51}=[3]; 
R{52}=[3]; 
R{53}=[3]; 
R{54}=[3]; 
R{55}=[3]; 
R{56}=[3]; 
R{57}=[3]; 
R{58}=[3]; 
R{59}=[3]; 
R{60}=[3]; 
R{61}=[3]; 
R{62}=[1,2]; 
R{63}=[1,2]; 
R{64}=[1,2]; 
R{65}=[1,2]; 
R{66}=[1,2]; 
R{67}=[1,2]; 
R{68}=[1,2]; 
R{69}=[1,2]; 
R{70}=[1,2]; 
R{71}=[1,2]; 
R{72}=[1,2]; 
R{73}=[1,2]; 
R{74}=[1,2]; 
R{75}=[1,2]; 
R{76}=[1,2]; 
R{77}=[1,2]; 
R{78}=[1,2]; 
R{79}=[1,2]; 
R{80}=[1,2]; 
R{81}=[1,2]; 
R{82}=[1,2]; 
R{83}=[1,2]; 
R{84}=[1,2]; 
R{85}=[1,2]; 
R{86}=[1,2]; 
R{87}=[1,2]; 
R{88}=[1,2]; 
R{89}=[1,2]; 
R{90}=[1,2]; 
R{91}=[1,2]; 
R{92}=[1,2]; 
R{93}=[1,2]; 
R{94}=[1,2]; 
R{95}=[1,2]; 
R{96}=[1,2]; 
R{97}=[1,2]; 
R{98}=[1,2]; 
R{99}=[1,2]; 
R{100}=[1,2]; 
R{101}=[1,2]; 
R{102}=[1,2]; 
R{103}=[1,2]; 
R{104}=[1,2]; 
R{105}=[1,2]; 
R{106}=[1,2]; 
R{107}=[1,2]; 
R{108}=[1,2]; 
R{109}=[1,2]; 
R{110}=[1,2]; 
R{111}=[1,2]; 
R{112}=[8,9]; 
R{113}=[8,9]; 
R{114}=[8,9]; 
R{115}=[8,9]; 
R{116}=[8,9]; 
R{117}=[8,9]; 
R{118}=[8,9]; 
R{119}=[8,9]; 
R{120}=[8,9]; 
R{121}=[8,9]; 
R{122}=[8,9]; 
R{123}=[8,9]; 
R{124}=[8,9]; 
R{125}=[8,9]; 
R{126}=[8,9]; 
R{127}=[8,9]; 
R{128}=[8,9]; 
R{129}=[8,9]; 
R{130}=[8,9]; 
R{131}=[8,9]; 
R{132}=[8,9]; 
R{133}=[8,9]; 
R{134}=[8,9]; 
R{135}=[8,9]; 
R{136}=[8,9]; 
R{137}=[8,9]; 
R{138}=[8,9]; 
R{139}=[8,9]; 
R{140}=[8,9]; 
R{141}=[8,9]; 
R{142}=[8,9]; 
R{143}=[8,9]; 
R{144}=[8,9]; 
R{145}=[8,9]; 
R{146}=[8,9]; 
R{147}=[8,9]; 
R{148}=[8,9]; 
R{149}=[8,9]; 
R{150}=[8,9]; 
R{151}=[8,9]; 
R{152}=[8,9]; 
R{153}=[8,9]; 
R{154}=[8,9]; 
R{155}=[8,9]; 
R{156}=[8,9]; 
R{157}=[8,9]; 
R{158}=[8,9]; 
R{159}=[8,9]; 
R{160}=[8,9]; 
R{161}=[8,9]; 
R{162}=[8,9]; 
R{163}=[8,9]; 
R{164}=[8,9]; 
R{165}=[8,9]; 
R{166}=[8,9]; 
R{167}=[8,9]; 
R{168}=[8,9]; 
R{169}=[8,9]; 
R{170}=[8,9]; 
R{171}=[8,9]; 
R{172}=[8,9]; 
R{173}=[8,9]; 
R{174}=[8,9]; 
R{175}=[8,9]; 
R{176}=[8,9]; 
R{177}=[8,9]; 
R{178}=[8,9]; 
R{179}=[8,9]; 
R{180}=[8,9]; 
R{181}=[8,9]; 
R{182}=[8,9]; 
R{183}=[8,9]; 
R{184}=[8,9]; 
R{185}=[8,9]; 
R{186}=[8,9]; 
R{187}=[8,9]; 
R{188}=[8,9]; 
R{189}=[8,9]; 
R{190}=[8,9]; 
R{191}=[8,9]; 
R{192}=[8,9]; 
R{193}=[8,9]; 
R{194}=[8,9]; 
R{195}=[8,9]; 
R{196}=[8,9]; 
R{197}=[8,9]; 
R{198}=[8,9]; 
R{199}=[8,9]; 
R{200}=[8,9]; 
R{201}=[8,9]; 
R{202}=[8,9]; 
R{203}=[8,9]; 
R{204}=[8,9]; 
R{205}=[8,9]; 
R{206}=[8,9]; 
R{207}=[8,9]; 
R{208}=[8,9]; 
R{209}=[8,9]; 
R{210}=[8,9]; 
R{211}=[8,9]; 
R{212}=[8,9]; 
R{213}=[8,9]; 
R{214}=[8,9]; 
R{215}=[8,9]; 
R{216}=[8,9]; 
R{217}=[8,9]; 
R{218}=[8,9]; 
R{219}=[8,9]; 
R{220}=[8,9]; 
R{221}=[8,9]; 
R{222}=[8,9]; 
R{223}=[8,9]; 
R{224}=[8,9]; 
R{225}=[8,9]; 
R{226}=[8,9]; 
R{227}=[8,9]; 
R{228}=[8,9]; 
R{229}=[8,9]; 
R{230}=[8,9]; 
R{231}=[8,9]; 
R{232}=[8,9]; 
R{233}=[8,9]; 
R{234}=[8,9]; 
R{235}=[8,9]; 
R{236}=[8,9]; 
R{237}=[8,9]; 
R{238}=[8,9]; 
R{239}=[8,9]; 
R{240}=[8,9]; 
R{241}=[8,9]; 
R{242}=[8,9]; 
R{243}=[8,9]; 
R{244}=[8,9]; 
R{245}=[8,9]; 
R{246}=[8,9]; 
R{247}=[8,9]; 
R{248}=[6,7]; 
R{249}=[6,7]; 
R{250}=[6,7]; 
R{251}=[6,7]; 
R{252}=[6,7]; 
R{253}=[6,7]; 
R{254}=[6,7]; 
R{255}=[6,7]; 
R{256}=[6,7]; 
R{257}=[6,7]; 
R{258}=[6,7]; 
R{259}=[6,7]; 
R{260}=[6,7]; 
R{261}=[6,7]; 
R{262}=[6,7]; 
R{263}=[6,7]; 
R{264}=[6,7]; 
R{265}=[6,7]; 
R{266}=[6,7]; 
R{267}=[6,7]; 
R{268}=[6,7]; 
R{269}=[6,7]; 
R{270}=[6,7]; 
R{271}=[6,7]; 
R{272}=[6,7]; 
R{273}=[6,7]; 
R{274}=[6,7]; 
R{275}=[6,7]; 
R{276}=[6,7]; 
R{277}=[6,7]; 
R{278}=[6,7]; 
R{279}=[6,7]; 
R{280}=[6,7]; 
R{281}=[6,7]; 
R{282}=[6,7]; 
R{283}=[6,7]; 
R{284}=[6,7]; 
R{285}=[6,7]; 
R{286}=[6,7]; 
R{287}=[6,7]; 
R{288}=[6,7]; 
R{289}=[6,7]; 
R{290}=[6,7]; 
R{291}=[6,7]; 
R{292}=[6,7]; 
R{293}=[6,7]; 
R{294}=[6,7]; 
R{295}=[6,7]; 
R{296}=[6,7]; 
R{297}=[6,7]; 
R{298}=[6,7]; 
R{299}=[6,7]; 
R{300}=[6,7]; 
R{301}=[6,7]; 
R{302}=[6,7]; 
R{303}=[6,7]; 
R{304}=[6,7]; 
R{305}=[6,7]; 
R{306}=[6,7]; 
R{307}=[6,7]; 
R{308}=[6,7]; 
R{309}=[6,7]; 
R{310}=[6,7]; 
R{311}=[4,5]; 
R{312}=[4,5]; 
R{313}=[4,5]; 
R{314}=[4,5]; 
R{315}=[4,5]; 
R{316}=[4,5]; 
R{317}=[4,5]; 
R{318}=[4,5]; 
R{319}=[4,5]; 
R{320}=[4,5]; 
R{321}=[4,5]; 
R{322}=[4,5]; 
R{323}=[4,5]; 
R{324}=[4,5]; 
R{325}=[4,5]; 
R{326}=[4,5]; 
R{327}=[4,5]; 
R{328}=[4,5]; 
R{329}=[4,5]; 
R{330}=[4,5]; 
R{331}=[4,5]; 
R{332}=[4,5]; 
R{333}=[4,5]; 
R{334}=[4,5]; 
R{335}=[4,5]; 
R{336}=[4,5]; 
R{337}=[4,5]; 
R{338}=[4,5]; 
R{339}=[4,5]; 
R{340}=[4,5]; 
R{341}=[4,5]; 
R{342}=[4,5]; 
R{343}=[4,5]; 
R{344}=[4,5]; 
R{345}=[4,5]; 
R{346}=[4,5]; 
R{347}=[4,5]; 
R{348}=[4,5]; 
R{349}=[4,5]; 
R{350}=[4,5]; 
R{351}=[4,5]; 
R{352}=[4,5]; 
R{353}=[4,5]; 
R{354}=[4,5]; 
R{355}=[4,5]; 
R{356}=[4,5]; 
R{357}=[4,5]; 
R{358}=[4,5]; 
R{359}=[4,5]; 
R{360}=[10,11]; 
R{361}=[10,11]; 
R{362}=[10,11]; 
R{363}=[10,11]; 
R{364}=[10,11]; 
R{365}=[10,11]; 
R{366}=[10,11]; 
R{367}=[10,11]; 
R{368}=[10,11]; 
R{369}=[10,11]; 
R{370}=[10,11]; 
R{371}=[10,11]; 
R{372}=[10,11]; 
R{373}=[10,11]; 
R{374}=[10,11]; 
R{375}=[10,11]; 
R{376}=[10,11]; 
R{377}=[10,11]; 
R{378}=[10,11]; 
R{379}=[10,11]; 
R{380}=[10,11]; 
R{381}=[10,11]; 
R{382}=[10,11]; 
R{383}=[10,11]; 
R{384}=[10,11]; 
R{385}=[10,11]; 
R{386}=[10,11]; 
R{387}=[10,11]; 
R{388}=[10,11]; 
R{389}=[10,11]; 
R{390}=[10,11]; 
R{391}=[10,11]; 
R{392}=[10,11]; 
R{393}=[10,11]; 
R{394}=[10,11]; 
R{395}=[10,11]; 
R{396}=[10,11]; 
R{397}=[10,11]; 
R{398}=[10,11]; 
R{399}=[10,11]; 
R{400}=[10,11]; 
R{401}=[10,11]; 
R{402}=[10,11]; 
R{403}=[10,11]; 
R{404}=[10,11]; 
R{405}=[10,11]; 
R{406}=[10,11]; 
R{407}=[10,11]; 
R{408}=[10,11]; 
R{409}=[10,11]; 
R{410}=[10,11]; 
R{411}=[10,11]; 
R{412}=[10,11]; 
R{413}=[10,11]; 
R{414}=[10,11]; 
R{415}=[10,11]; 
R{416}=[10,11]; 
R{417}=[12,13]; 
R{418}=[12,13]; 
R{419}=[12,13]; 
R{420}=[12,13]; 
R{421}=[12,13]; 
R{422}=[12,13]; 
R{423}=[12,13]; 
R{424}=[12,13]; 
R{425}=[12,13]; 
R{426}=[12,13]; 
R{427}=[12,13]; 
R{428}=[12,13]; 
R{429}=[12,13]; 
R{430}=[12,13]; 
R{431}=[12,13]; 
R{432}=[12,13]; 
R{433}=[12,13]; 
R{434}=[12,13]; 
R{435}=[12,13]; 
R{436}=[12,13]; 
R{437}=[12,13]; 
R{438}=[12,13]; 
R{439}=[12,13]; 
R{440}=[12,13]; 
R{441}=[12,13]; 
R{442}=[12,13]; 
R{443}=[12,13]; 
R{444}=[12,13]; 
R{445}=[12,13]; 
R{446}=[12,13]; 
R{447}=[12,13]; 
R{448}=[12,13]; 
R{449}=[12,13]; 
R{450}=[12,13]; 
R{451}=[12,13]; 
R{452}=[12,13]; 
R{453}=[12,13]; 
R{454}=[12,13]; 
R{455}=[12,13]; 
R{456}=[12,13]; 
R{457}=[12,13]; 
R{458}=[12,13]; 
R{459}=[12,13]; 
R{460}=[12,13]; 
R{461}=[12,13]; 
R{462}=[12,13]; 
R{463}=[12,13]; 
R{464}=[12,13]; 
R{465}=[12,13]; 
R{466}=[12,13]; 
R{467}=[12,13]; 
R{468}=[12,13]; 
R{469}=[12,13]; 
R{470}=[12,13]; 
R{471}=[12,13]; 
R{472}=[12,13]; 
R{473}=[12,13]; 
R{474}=[12,13]; 
R{475}=[12,13]; 
R{476}=[12,13]; 
R{477}=[12,13]; 
R{478}=[12,13]; 
R{479}=[12,13]; 
R{480}=[12,13]; 
R{481}=[12,13]; 
R{482}=[12,13]; 
R{483}=[12,13]; 
R{484}=[12,13]; 
R{485}=[12,13]; 
R{486}=[12,13]; 
R{487}=[12,13]; 
R{488}=[12,13]; 
R{489}=[12,13]; 
R{490}=[12,13]; 
R{491}=[12,13]; 
R{492}=[12,13]; 
R{493}=[12,13]; 
R{494}=[12,13]; 
R{495}=[12,13]; 
R{496}=[12,13]; 
R{497}=[12,13]; 
R{498}=[12,13]; 
R{499}=[12,13]; 
R{500}=[12,13]; 
R{501}=[12,13]; 
R{502}=[12,13]; 
R{503}=[12,13]; 
R{504}=[12,13]; 
R{505}=[12,13]; 
R{506}=[12,13]; 
R{507}=[12,13]; 
R{508}=[12,13]; 
R{509}=[12,13]; 
R{510}=[12,13]; 
R{511}=[12,13]; 
R{512}=[12,13]; 
R{513}=[12,13]; 
R{514}=[12,13]; 
R{515}=[12,13]; 
R{516}=[12,13]; 
R{517}=[12,13]; 
R{518}=[12,13]; 
R{519}=[12,13]; 
R{520}=[12,13]; 
R{521}=[12,13]; 
R{522}=[12,13]; 
R{523}=[12,13]; 
R{524}=[12,13]; 
R{525}=[12,13]; 
R{526}=[12,13]; 
R{527}=[12,13]; 
R{528}=[12,13]; 
R{529}=[12,13]; 
R{530}=[12,13]; 
R{531}=[12,13]; 
R{532}=[12,13]; 
R{533}=[12,13]; 
R{534}=[12,13]; 
R{535}=[12,13]; 
R{536}=[12,13]; 
R{537}=[12,13]; 
R{538}=[12,13]; 
R{539}=[12,13]; 
R{540}=[12,13]; 
R{541}=[12,13]; 
R{542}=[12,13]; 
R{543}=[12,13]; 
R{544}=[12,13]; 
R{545}=[12,13]; 
R{546}=[12,13]; 
R{547}=[12,13]; 
R{548}=[12,13]; 
R{549}=[12,13]; 
R{550}=[12,13]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%% ordenacion procesamiento de trenes            %%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
[t_pla,I]=InitOrden(initia,t_pla,n_t); % inicializacion del orden del procesamiento
at=at(I); 
vt=vt.^(-1); 
vt=vt(I); 
Ntipotren=Ntipotren(I); 
Raux=R; 
Marcha=Marcha(I,:); 
for i=1:n_t 
   R{i}=Raux{I(i)}; 
end 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 %%%                 tiempo de viaje trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 for t1=1:n_t 
     for i_r=1:length(R{t1}) 
         D_t(t1,i_r)=TVr(R{t1}(i_r))*vt(t1)-at(t1); 
     end 
 end 
 n_s=0; % numero máximo de conflicto entre un par de trenes 
for t1=1:n_t-1 
    for t2=t1+1:n_t 
        for i_r1=1:length(R{t1}) 
            r1=R{t1}(i_r1); 
            for i_r2=1:length(R{t2}) 
                r2=R{t2}(i_r2); 
                if length(C{r1,r2})>0 
                C_t{i_r1,i_r2,t1,t2}=[C{r1,r2}(:,1:2)*vt(t1) C{r1,r2}(:,3:4)*vt(t2)]; 
                C_t{i_r2,i_r1,t2,t1}=[C{r2,r1}(:,1:2)*vt(t2) C{r2,r1}(:,3:4)*vt(t1)]; 
                n_s=max(n_s,size(C_t{i_r1,i_r2,t1,t2},1)); 
                end 
            end 
        end 
    end 
end 
%%%%%%%%%%% FIN PROBLEMA4b

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
    case 'Problem4c' % P R O B L E M   4 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%    RUTAS: MATRIZ DE CONFLICTOS Y TIEMPOS DE VIAJES 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
Mueve=@(A) [A(:,3) A(:,4) A(:,1) A(:,2)]; 
n_rutas=17 ;  
t_pla=[5.233 ; 5.417 ; 5.700 ; 5.900 ; 6.050 ; 6.250 ; 6.633 ; 6.883 ; 7.133 ; 7.350 ; 7.500 ; 7.850 ; 7.967 ; 8.350 ; 8.617 ; 8.850 ; 9.117 ; 9.350 ; 9.617 ; 9.850 ; 10.367 ; 10.850 ; 11.367 ; 11.850 ; 12.367 ; 12.817 ; 13.367 ; 13.850 ; 14.100 ; 14.367 ; 14.600 ; 14.850 ; 15.133 ; 15.350 ; 15.600 ; 15.850 ; 16.100 ; 16.350 ; 16.600 ; 16.850 ; 17.100 ; 17.350 ; 17.617 ; 17.850 ; 18.100 ; 18.350 ; 18.600 ; 18.850 ; 19.100 ; 19.350 ; 19.633 ; 19.850 ; 20.100 ; 20.350 ; 20.867 ; 21.367 ; 21.850 ; 22.367 ; 22.850 ; 23.350 ; 23.850 ; 5.217 ; 6.500 ; 6.717 ; 7.000 ; 7.700 ; 8.017 ; 8.233 ; 8.467 ; 8.733 ; 8.967 ; 9.200 ; 9.467 ; 9.700 ; 9.983 ; 10.200 ; 10.667 ; 11.183 ; 11.683 ; 12.183 ; 12.683 ; 13.183 ; 13.683 ; 13.967 ; 14.183 ; 14.483 ; 14.700 ; 14.967 ; 15.200 ; 15.483 ; 15.650 ; 16.217 ; 16.700 ; 17.200 ; 17.700 ; 18.200 ; 18.483 ; 18.700 ; 18.983 ; 19.200 ; 19.467 ; 19.683 ; 19.967 ; 20.200 ; 20.700 ; 21.200 ; 21.700 ; 22.200 ; 22.700 ; 23.200 ; 23.700 ; 4.950 ; 5.400 ; 5.600 ; 5.750 ; 5.800 ; 5.950 ; 6.000 ; 6.200 ; 6.300 ; 6.400 ; 6.517 ; 6.633 ; 6.750 ; 6.800 ; 6.900 ; 7.000 ; 7.100 ; 7.200 ; 7.333 ; 7.450 ; 7.550 ; 7.600 ; 7.700 ; 7.783 ; 7.900 ; 8.000 ; 8.100 ; 8.200 ; 8.283 ; 8.400 ; 8.500 ; 8.583 ; 8.700 ; 8.800 ; 8.917 ; 9.000 ; 9.100 ; 9.200 ; 9.300 ; 9.400 ; 9.500 ; 9.617 ; 9.733 ; 9.833 ; 9.950 ; 10.050 ; 10.200 ; 10.300 ; 10.533 ; 10.683 ; 10.833 ; 11.017 ; 11.183 ; 11.350 ; 11.517 ; 11.683 ; 11.850 ; 12.017 ; 12.183 ; 12.350 ; 12.517 ; 12.650 ; 12.850 ; 13.017 ; 13.183 ; 13.333 ; 13.517 ; 13.683 ; 13.850 ; 14.000 ; 14.183 ; 14.400 ; 14.533 ; 14.683 ; 14.783 ; 14.933 ; 15.050 ; 15.183 ; 15.283 ; 15.400 ; 15.533 ; 15.683 ; 15.833 ; 16.017 ; 16.183 ; 16.367 ; 16.517 ; 16.683 ; 16.850 ; 17.017 ; 17.183 ; 17.350 ; 17.517 ; 17.667 ; 17.800 ; 17.933 ; 18.050 ; 18.183 ; 18.300 ; 18.400 ; 18.533 ; 18.683 ; 18.833 ; 18.933 ; 19.050 ; 19.183 ; 19.267 ; 19.400 ; 19.533 ; 19.683 ; 19.800 ; 19.900 ; 20.050 ; 20.200 ; 20.333 ; 20.433 ; 20.533 ; 20.650 ; 20.817 ; 20.933 ; 21.050 ; 21.200 ; 21.283 ; 21.417 ; 21.550 ; 21.700 ; 21.833 ; 22.033 ; 22.183 ; 22.383 ; 22.517 ; 22.683 ; 22.833 ; 22.933 ; 23.167 ; 23.383 ; 5.417 ; 5.733 ; 6.017 ; 6.183 ; 6.350 ; 6.517 ; 6.683 ; 6.850 ; 6.983 ; 7.100 ; 7.183 ; 7.267 ; 7.350 ; 7.433 ; 7.517 ; 7.600 ; 7.667 ; 7.733 ; 7.800 ; 7.867 ; 7.933 ; 8.000 ; 8.067 ; 8.133 ; 8.200 ; 8.283 ; 8.350 ; 8.417 ; 8.483 ; 8.550 ; 8.617 ; 8.700 ; 8.783 ; 8.867 ; 8.950 ; 9.033 ; 9.117 ; 9.200 ; 9.283 ; 9.367 ; 9.450 ; 9.550 ; 9.650 ; 9.750 ; 9.850 ; 9.983 ; 10.133 ; 10.300 ; 10.467 ; 10.633 ; 10.800 ; 10.967 ; 11.133 ; 11.300 ; 11.467 ; 11.633 ; 11.800 ; 11.967 ; 12.133 ; 12.300 ; 12.483 ; 12.633 ; 12.800 ; 12.967 ; 13.133 ; 13.300 ; 13.433 ; 13.567 ; 13.700 ; 13.833 ; 13.933 ; 14.033 ; 14.133 ; 14.233 ; 14.333 ; 14.433 ; 14.533 ; 14.633 ; 14.733 ; 14.833 ; 14.933 ; 15.033 ; 15.133 ; 15.233 ; 15.333 ; 15.433 ; 15.533 ; 15.633 ; 15.733 ; 15.833 ; 15.933 ; 16.067 ; 16.200 ; 16.333 ; 16.467 ; 16.600 ; 16.733 ; 16.867 ; 17.000 ; 17.133 ; 17.267 ; 17.400 ; 17.533 ; 17.667 ; 17.800 ; 17.933 ; 18.033 ; 18.133 ; 18.233 ; 18.333 ; 18.433 ; 18.533 ; 18.633 ; 18.733 ; 18.833 ; 18.933 ; 19.033 ; 19.133 ; 19.233 ; 19.333 ; 19.433 ; 19.533 ; 19.633 ; 19.733 ; 19.833 ; 19.933 ; 20.033 ; 20.133 ; 20.233 ; 20.367 ; 20.500 ; 20.633 ; 20.767 ; 20.900 ; 21.033 ; 21.167 ; 21.317 ; 21.483 ; 21.650 ; 21.817 ; 21.983 ; 22.150 ; 22.317 ; 22.483 ; 22.733 ; 22.983 ; 23.233 ; 23.483 ; 23.733 ; 5.983 ; 6.267 ; 6.517 ; 6.750 ; 6.983 ; 7.167 ; 7.367 ; 7.567 ; 7.750 ; 7.967 ; 8.117 ; 8.367 ; 8.533 ; 8.700 ; 8.967 ; 9.167 ; 9.367 ; 9.550 ; 9.750 ; 10.000 ; 10.267 ; 10.517 ; 10.983 ; 11.500 ; 11.983 ; 12.517 ; 12.983 ; 13.517 ; 13.983 ; 14.267 ; 14.500 ; 14.767 ; 14.983 ; 15.267 ; 15.500 ; 15.767 ; 15.983 ; 16.250 ; 16.517 ; 16.750 ; 16.983 ; 17.517 ; 17.750 ; 17.983 ; 18.267 ; 18.483 ; 18.750 ; 19.000 ; 19.250 ; 19.483 ; 19.750 ; 19.983 ; 20.250 ; 20.517 ; 20.750 ; 20.983 ; 21.267 ; 21.533 ; 22.017 ; 22.517 ; 22.983 ; 23.517 ; 0.050 ; 6.433 ; 6.650 ; 6.933 ; 7.633 ; 7.950 ; 8.167 ; 8.400 ; 8.667 ; 8.900 ; 9.133 ; 9.400 ; 9.633 ; 9.917 ; 10.133 ; 10.600 ; 11.117 ; 11.617 ; 12.117 ; 12.617 ; 13.117 ; 13.617 ; 13.900 ; 14.117 ; 14.417 ; 14.633 ; 14.900 ; 15.133 ; 15.417 ; 15.583 ; 16.150 ; 16.633 ; 17.133 ; 17.633 ; 18.133 ; 18.417 ; 18.633 ; 18.917 ; 19.133 ; 19.400 ; 19.617 ; 19.900 ; 20.133 ; 20.633 ; 21.133 ; 21.633 ; 22.133 ; 22.633 ; 23.133 ; 23.633 ; 6.033 ; 6.333 ; 6.567 ; 6.833 ; 7.133 ; 7.367 ; 7.533 ; 7.633 ; 7.817 ; 8.133 ; 8.333 ; 8.433 ; 8.617 ; 8.833 ; 9.033 ; 9.333 ; 9.667 ; 10.083 ; 10.583 ; 11.050 ; 11.567 ; 12.083 ; 12.567 ; 13.067 ; 13.550 ; 13.933 ; 14.267 ; 14.567 ; 14.817 ; 15.083 ; 15.333 ; 15.583 ; 15.917 ; 16.250 ; 16.567 ; 16.900 ; 17.233 ; 17.733 ; 18.100 ; 18.433 ; 18.767 ; 18.983 ; 19.300 ; 19.717 ; 19.983 ; 20.233 ; 20.583 ; 20.967 ; 21.317 ; 21.633 ; 21.900 ; 22.267 ; 22.583 ; 22.867 ; 23.233 ; 23.550 ; 23.867 ; 5.583 ; 5.783 ; 5.983 ; 6.183 ; 6.283 ; 6.383 ; 6.483 ; 6.617 ; 6.733 ; 6.783 ; 6.883 ; 6.983 ; 7.083 ; 7.183 ; 7.317 ; 7.433 ; 7.583 ; 7.683 ; 7.767 ; 7.883 ; 7.983 ; 8.083 ; 8.183 ; 8.267 ; 8.383 ; 8.483 ; 8.567 ; 8.683 ; 8.783 ; 8.900 ; 8.983 ; 9.083 ; 9.183 ; 9.283 ; 9.383 ; 9.483 ; 9.600 ; 9.717 ; 9.817 ; 9.933 ; 10.033 ; 10.183 ; 10.283 ; 10.417 ; 10.517 ; 10.667 ; 10.817 ; 11.000 ; 11.167 ; 11.333 ; 11.500 ; 11.667 ; 11.833 ; 12.000 ; 12.167 ; 12.333 ; 12.500 ; 12.633 ; 12.833 ; 13.000 ; 13.167 ; 13.317 ; 13.500 ; 13.667 ; 13.833 ; 13.983 ; 14.167 ; 14.383 ; 14.517 ; 14.667 ; 14.767 ; 14.917 ; 15.033 ; 15.167 ; 15.267 ; 15.383 ; 15.517 ; 15.667 ; 15.817 ; 16.000 ; 16.167 ; 16.350 ; 16.500 ; 16.667 ; 16.833 ; 17.000 ; 17.167 ; 17.333 ; 17.500 ; 17.650 ; 17.783 ; 17.917 ; 18.033 ; 18.167 ; 18.283 ; 18.383 ; 18.517 ; 18.667 ; 18.817 ; 18.917 ; 19.033 ; 19.167 ; 19.250 ; 19.383 ; 19.517 ; 19.667 ; 19.783 ; 19.883 ; 20.033 ; 20.183 ; 20.317 ; 20.417 ; 20.517 ; 20.633 ; 20.800 ; 20.917 ; 21.033 ; 21.183 ; 21.267 ; 21.400 ; 21.533 ; 21.683 ; 21.817 ; 22.017 ; 22.167 ; 22.367 ; 22.500 ; 22.667 ; 22.817 ; 22.917 ; 23.150 ; 23.367 ; 23.650 ; 23.917 ; 5.617 ; 5.933 ; 6.100 ; 6.267 ; 6.433 ; 6.600 ; 6.767 ; 6.867 ; 6.950 ; 7.033 ; 7.117 ; 7.200 ; 7.283 ; 7.367 ; 7.450 ; 7.533 ; 7.617 ; 7.700 ; 7.783 ; 7.867 ; 7.950 ; 8.033 ; 8.117 ; 8.200 ; 8.267 ; 8.333 ; 8.400 ; 8.467 ; 8.533 ; 8.600 ; 8.667 ; 8.733 ; 8.800 ; 8.867 ; 8.933 ; 9.000 ; 9.067 ; 9.133 ; 9.200 ; 9.267 ; 9.350 ; 9.433 ; 9.517 ; 9.600 ; 9.683 ; 9.767 ; 9.933 ; 10.100 ; 10.250 ; 10.433 ; 10.600 ; 10.767 ; 10.933 ; 11.100 ; 11.267 ; 11.433 ; 11.600 ; 11.767 ; 11.933 ; 12.100 ; 12.267 ; 12.433 ; 12.600 ; 12.767 ; 12.933 ; 13.100 ; 13.267 ; 13.433 ; 13.567 ; 13.700 ; 13.833 ; 13.950 ; 14.050 ; 14.150 ; 14.250 ; 14.350 ; 14.450 ; 14.550 ; 14.650 ; 14.750 ; 14.850 ; 14.950 ; 15.050 ; 15.150 ; 15.250 ; 15.350 ; 15.450 ; 15.550 ; 15.650 ; 15.750 ; 15.850 ; 15.950 ; 16.067 ; 16.200 ; 16.333 ; 16.467 ; 16.600 ; 16.733 ; 16.867 ; 17.000 ; 17.133 ; 17.267 ; 17.400 ; 17.533 ; 17.667 ; 17.800 ; 17.917 ; 18.017 ; 18.117 ; 18.217 ; 18.317 ; 18.417 ; 18.517 ; 18.617 ; 18.717 ; 18.817 ; 18.917 ; 19.017 ; 19.117 ; 19.217 ; 19.317 ; 19.417 ; 19.517 ; 19.617 ; 19.717 ; 19.817 ; 19.917 ; 20.017 ; 20.117 ; 20.217 ; 20.367 ; 20.500 ; 20.617 ; 20.767 ; 20.900 ; 21.033 ; 21.167 ; 21.300 ; 21.433 ; 21.600 ; 21.767 ; 21.933 ; 22.100 ; 22.267 ; 22.433 ; 22.600 ; 22.933 ; 23.183 ; 23.500 ; 23.900 ; ]; 
t_pla=SimulacionRetraso(t_pla,version);
at=[5.321 ; 5.504 ; 5.788 ; 5.988 ; 6.138 ; 6.338 ; 6.721 ; 6.971 ; 7.221 ; 7.438 ; 7.588 ; 7.938 ; 8.054 ; 8.438 ; 8.704 ; 8.938 ; 9.204 ; 9.438 ; 9.704 ; 9.938 ; 10.454 ; 10.938 ; 11.454 ; 11.938 ; 12.454 ; 12.904 ; 13.454 ; 13.938 ; 14.188 ; 14.454 ; 14.688 ; 14.938 ; 15.221 ; 15.438 ; 15.688 ; 15.938 ; 16.187 ; 16.438 ; 16.687 ; 16.938 ; 17.187 ; 17.438 ; 17.704 ; 17.938 ; 18.187 ; 18.438 ; 18.687 ; 18.938 ; 19.187 ; 19.438 ; 19.721 ; 19.938 ; 20.187 ; 20.438 ; 20.954 ; 21.454 ; 21.938 ; 22.454 ; 22.938 ; 23.438 ; 23.938 ; 5.304 ; 6.588 ; 6.804 ; 7.088 ; 7.788 ; 8.104 ; 8.321 ; 8.554 ; 8.821 ; 9.054 ; 9.287 ; 9.554 ; 9.787 ; 10.071 ; 10.287 ; 10.754 ; 11.271 ; 11.771 ; 12.271 ; 12.771 ; 13.271 ; 13.771 ; 14.054 ; 14.271 ; 14.571 ; 14.787 ; 15.054 ; 15.287 ; 15.571 ; 15.738 ; 16.304 ; 16.788 ; 17.288 ; 17.788 ; 18.288 ; 18.571 ; 18.788 ; 19.071 ; 19.288 ; 19.554 ; 19.771 ; 20.054 ; 20.288 ; 20.788 ; 21.288 ; 21.788 ; 22.288 ; 22.788 ; 23.288 ; 23.788 ; 5.038 ; 5.488 ; 5.688 ; 5.838 ; 5.888 ; 6.038 ; 6.088 ; 6.288 ; 6.388 ; 6.488 ; 6.604 ; 6.721 ; 6.838 ; 6.888 ; 6.988 ; 7.088 ; 7.188 ; 7.288 ; 7.421 ; 7.537 ; 7.638 ; 7.688 ; 7.788 ; 7.871 ; 7.988 ; 8.088 ; 8.188 ; 8.287 ; 8.371 ; 8.488 ; 8.588 ; 8.671 ; 8.787 ; 8.888 ; 9.004 ; 9.088 ; 9.188 ; 9.287 ; 9.387 ; 9.488 ; 9.588 ; 9.704 ; 9.821 ; 9.921 ; 10.038 ; 10.137 ; 10.287 ; 10.387 ; 10.621 ; 10.771 ; 10.921 ; 11.104 ; 11.271 ; 11.438 ; 11.604 ; 11.771 ; 11.938 ; 12.104 ; 12.271 ; 12.438 ; 12.604 ; 12.738 ; 12.938 ; 13.104 ; 13.271 ; 13.421 ; 13.604 ; 13.771 ; 13.938 ; 14.088 ; 14.271 ; 14.488 ; 14.621 ; 14.771 ; 14.871 ; 15.021 ; 15.137 ; 15.271 ; 15.371 ; 15.488 ; 15.621 ; 15.771 ; 15.921 ; 16.104 ; 16.271 ; 16.454 ; 16.604 ; 16.771 ; 16.938 ; 17.104 ; 17.271 ; 17.438 ; 17.604 ; 17.754 ; 17.887 ; 18.021 ; 18.137 ; 18.271 ; 18.387 ; 18.487 ; 18.621 ; 18.771 ; 18.921 ; 19.021 ; 19.137 ; 19.271 ; 19.354 ; 19.487 ; 19.621 ; 19.771 ; 19.887 ; 19.987 ; 20.137 ; 20.288 ; 20.421 ; 20.521 ; 20.621 ; 20.738 ; 20.904 ; 21.021 ; 21.137 ; 21.288 ; 21.371 ; 21.504 ; 21.637 ; 21.788 ; 21.921 ; 22.121 ; 22.271 ; 22.471 ; 22.604 ; 22.771 ; 22.921 ; 23.021 ; 23.254 ; 23.471 ; 5.504 ; 5.821 ; 6.104 ; 6.271 ; 6.438 ; 6.604 ; 6.771 ; 6.938 ; 7.071 ; 7.188 ; 7.271 ; 7.354 ; 7.438 ; 7.521 ; 7.604 ; 7.688 ; 7.754 ; 7.821 ; 7.888 ; 7.954 ; 8.021 ; 8.088 ; 8.154 ; 8.221 ; 8.287 ; 8.371 ; 8.438 ; 8.504 ; 8.571 ; 8.638 ; 8.704 ; 8.787 ; 8.871 ; 8.954 ; 9.038 ; 9.121 ; 9.204 ; 9.287 ; 9.371 ; 9.454 ; 9.537 ; 9.638 ; 9.738 ; 9.837 ; 9.938 ; 10.071 ; 10.221 ; 10.387 ; 10.554 ; 10.721 ; 10.888 ; 11.054 ; 11.221 ; 11.387 ; 11.554 ; 11.721 ; 11.888 ; 12.054 ; 12.221 ; 12.387 ; 12.571 ; 12.721 ; 12.888 ; 13.054 ; 13.221 ; 13.387 ; 13.521 ; 13.654 ; 13.787 ; 13.921 ; 14.021 ; 14.121 ; 14.221 ; 14.321 ; 14.421 ; 14.521 ; 14.621 ; 14.721 ; 14.821 ; 14.921 ; 15.021 ; 15.121 ; 15.221 ; 15.321 ; 15.421 ; 15.521 ; 15.621 ; 15.721 ; 15.821 ; 15.921 ; 16.021 ; 16.154 ; 16.288 ; 16.421 ; 16.554 ; 16.687 ; 16.821 ; 16.954 ; 17.087 ; 17.221 ; 17.354 ; 17.487 ; 17.621 ; 17.754 ; 17.887 ; 18.021 ; 18.121 ; 18.221 ; 18.321 ; 18.421 ; 18.521 ; 18.621 ; 18.721 ; 18.821 ; 18.921 ; 19.021 ; 19.121 ; 19.221 ; 19.321 ; 19.421 ; 19.521 ; 19.621 ; 19.721 ; 19.821 ; 19.921 ; 20.021 ; 20.121 ; 20.221 ; 20.321 ; 20.454 ; 20.587 ; 20.721 ; 20.854 ; 20.987 ; 21.121 ; 21.254 ; 21.404 ; 21.571 ; 21.738 ; 21.904 ; 22.071 ; 22.237 ; 22.404 ; 22.571 ; 22.821 ; 23.071 ; 23.321 ; 23.571 ; 23.821 ; 6.071 ; 6.354 ; 6.604 ; 6.838 ; 7.071 ; 7.254 ; 7.454 ; 7.654 ; 7.838 ; 8.054 ; 8.204 ; 8.454 ; 8.621 ; 8.787 ; 9.054 ; 9.254 ; 9.454 ; 9.638 ; 9.837 ; 10.088 ; 10.354 ; 10.604 ; 11.071 ; 11.588 ; 12.071 ; 12.604 ; 13.071 ; 13.604 ; 14.071 ; 14.354 ; 14.588 ; 14.854 ; 15.071 ; 15.354 ; 15.588 ; 15.854 ; 16.071 ; 16.337 ; 16.604 ; 16.837 ; 17.071 ; 17.604 ; 17.837 ; 18.071 ; 18.354 ; 18.571 ; 18.837 ; 19.087 ; 19.337 ; 19.571 ; 19.837 ; 20.071 ; 20.337 ; 20.604 ; 20.837 ; 21.071 ; 21.354 ; 21.621 ; 22.104 ; 22.604 ; 23.071 ; 23.604 ; 0.138 ; 6.521 ; 6.737 ; 7.021 ; 7.721 ; 8.037 ; 8.254 ; 8.488 ; 8.754 ; 8.987 ; 9.221 ; 9.488 ; 9.721 ; 10.004 ; 10.221 ; 10.688 ; 11.204 ; 11.704 ; 12.204 ; 12.704 ; 13.204 ; 13.704 ; 13.987 ; 14.204 ; 14.504 ; 14.721 ; 14.987 ; 15.221 ; 15.504 ; 15.671 ; 16.237 ; 16.721 ; 17.221 ; 17.721 ; 18.221 ; 18.504 ; 18.721 ; 19.004 ; 19.221 ; 19.487 ; 19.704 ; 19.987 ; 20.221 ; 20.721 ; 21.221 ; 21.721 ; 22.221 ; 22.721 ; 23.221 ; 23.721 ; 6.121 ; 6.421 ; 6.654 ; 6.921 ; 7.221 ; 7.454 ; 7.621 ; 7.721 ; 7.904 ; 8.221 ; 8.421 ; 8.521 ; 8.704 ; 8.921 ; 9.121 ; 9.421 ; 9.754 ; 10.171 ; 10.671 ; 11.137 ; 11.654 ; 12.171 ; 12.654 ; 13.154 ; 13.638 ; 14.021 ; 14.354 ; 14.654 ; 14.904 ; 15.171 ; 15.421 ; 15.671 ; 16.004 ; 16.337 ; 16.654 ; 16.987 ; 17.321 ; 17.821 ; 18.187 ; 18.521 ; 18.854 ; 19.071 ; 19.387 ; 19.804 ; 20.071 ; 20.321 ; 20.671 ; 21.054 ; 21.404 ; 21.721 ; 21.987 ; 22.354 ; 22.671 ; 22.954 ; 23.321 ; 23.637 ; 23.954 ; 5.671 ; 5.871 ; 6.071 ; 6.271 ; 6.371 ; 6.471 ; 6.571 ; 6.704 ; 6.821 ; 6.871 ; 6.971 ; 7.071 ; 7.171 ; 7.271 ; 7.404 ; 7.521 ; 7.671 ; 7.771 ; 7.854 ; 7.971 ; 8.071 ; 8.171 ; 8.271 ; 8.354 ; 8.471 ; 8.571 ; 8.654 ; 8.771 ; 8.871 ; 8.987 ; 9.071 ; 9.171 ; 9.271 ; 9.371 ; 9.471 ; 9.571 ; 9.688 ; 9.804 ; 9.904 ; 10.021 ; 10.121 ; 10.271 ; 10.371 ; 10.504 ; 10.604 ; 10.754 ; 10.904 ; 11.088 ; 11.254 ; 11.421 ; 11.588 ; 11.754 ; 11.921 ; 12.088 ; 12.254 ; 12.421 ; 12.588 ; 12.721 ; 12.921 ; 13.088 ; 13.254 ; 13.404 ; 13.588 ; 13.754 ; 13.921 ; 14.071 ; 14.254 ; 14.471 ; 14.604 ; 14.754 ; 14.854 ; 15.004 ; 15.121 ; 15.254 ; 15.354 ; 15.471 ; 15.604 ; 15.754 ; 15.904 ; 16.087 ; 16.254 ; 16.438 ; 16.587 ; 16.754 ; 16.921 ; 17.087 ; 17.254 ; 17.421 ; 17.587 ; 17.738 ; 17.871 ; 18.004 ; 18.121 ; 18.254 ; 18.371 ; 18.471 ; 18.604 ; 18.754 ; 18.904 ; 19.004 ; 19.121 ; 19.254 ; 19.337 ; 19.471 ; 19.604 ; 19.754 ; 19.871 ; 19.971 ; 20.121 ; 20.271 ; 20.404 ; 20.504 ; 20.604 ; 20.721 ; 20.887 ; 21.004 ; 21.121 ; 21.271 ; 21.354 ; 21.487 ; 21.621 ; 21.771 ; 21.904 ; 22.104 ; 22.254 ; 22.454 ; 22.587 ; 22.754 ; 22.904 ; 23.004 ; 23.237 ; 23.454 ; 23.738 ; 24.004 ; 5.704 ; 6.021 ; 6.188 ; 6.354 ; 6.521 ; 6.688 ; 6.854 ; 6.954 ; 7.038 ; 7.121 ; 7.204 ; 7.288 ; 7.371 ; 7.454 ; 7.537 ; 7.621 ; 7.704 ; 7.788 ; 7.871 ; 7.954 ; 8.037 ; 8.121 ; 8.204 ; 8.287 ; 8.354 ; 8.421 ; 8.488 ; 8.554 ; 8.621 ; 8.688 ; 8.754 ; 8.821 ; 8.888 ; 8.954 ; 9.021 ; 9.088 ; 9.154 ; 9.221 ; 9.287 ; 9.354 ; 9.438 ; 9.521 ; 9.604 ; 9.688 ; 9.771 ; 9.854 ; 10.021 ; 10.188 ; 10.338 ; 10.521 ; 10.688 ; 10.854 ; 11.021 ; 11.188 ; 11.354 ; 11.521 ; 11.688 ; 11.854 ; 12.021 ; 12.188 ; 12.354 ; 12.521 ; 12.688 ; 12.854 ; 13.021 ; 13.188 ; 13.354 ; 13.521 ; 13.654 ; 13.787 ; 13.921 ; 14.038 ; 14.137 ; 14.238 ; 14.338 ; 14.438 ; 14.537 ; 14.638 ; 14.738 ; 14.837 ; 14.938 ; 15.038 ; 15.137 ; 15.238 ; 15.338 ; 15.438 ; 15.537 ; 15.638 ; 15.738 ; 15.837 ; 15.938 ; 16.038 ; 16.154 ; 16.288 ; 16.421 ; 16.554 ; 16.687 ; 16.821 ; 16.954 ; 17.087 ; 17.221 ; 17.354 ; 17.487 ; 17.621 ; 17.754 ; 17.887 ; 18.004 ; 18.104 ; 18.204 ; 18.304 ; 18.404 ; 18.504 ; 18.604 ; 18.704 ; 18.804 ; 18.904 ; 19.004 ; 19.104 ; 19.204 ; 19.304 ; 19.404 ; 19.504 ; 19.604 ; 19.704 ; 19.804 ; 19.904 ; 20.004 ; 20.104 ; 20.204 ; 20.304 ; 20.454 ; 20.587 ; 20.704 ; 20.854 ; 20.987 ; 21.121 ; 21.254 ; 21.387 ; 21.521 ; 21.687 ; 21.854 ; 22.021 ; 22.187 ; 22.354 ; 22.521 ; 22.687 ; 23.021 ; 23.271 ; 23.587 ; 23.987 ; ]; 
vt=[40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; 40.0 ; ]; 
n_t=length(t_pla);  % número de trenes 
Ntipotren=[1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 1.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 5.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 13.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 9.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 3.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 7.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 19.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 15.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; 11.0 ; ]; 
tipotren={'C2+','','C2-','','C7+','','C7-','','C5+','','C5-','','C4+','','C4-','','C3+','','C3-'}; 
C{1,1}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{1,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
]; 
C{1,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{1,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,2}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,3}=[	    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{2,4}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,5}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,6}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{2,7}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,3}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{3,4}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,5}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,6}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{3,7}=[	    0.000 	    1.200 	    2.500 	    3.700  
			    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{4,4}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{4,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{4,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,5}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,6}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{5,7}=[	    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,6}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{6,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{7,7}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{8,8}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{8,9}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{9,9}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{9,10}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    1.250 	    3.450 	    0.250 	    2.450  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{9,11}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{9,12}=[	    1.000 	    1.450 	    2.250 	    2.700  
]; 
C{9,13}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    1.250 	    3.450 	    0.250 	    2.450  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{10,10}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{10,11}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{10,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
]; 
C{10,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,11}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{11,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{12,12}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{12,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{13,13}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{14,14}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{14,15}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{14,17}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{15,15}=[	    0.000 	    1.200 	    0.000 	    1.200  
			    1.000 	    1.450 	    1.000 	    1.450  
			    1.250 	    3.450 	    1.250 	    3.450  
			    3.250 	    3.700 	    3.250 	    3.700  
]; 
C{15,17}=[	    1.000 	    1.450 	    2.250 	    2.700  
			    1.250 	    3.450 	    0.250 	    2.450  
			    3.250 	    3.700 	    0.000 	    0.450  
]; 
C{16,16}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{16,17}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{17,17}=[	    2.500 	    3.700 	    2.500 	    3.700  
			    2.250 	    2.700 	    2.250 	    2.700  
			    0.250 	    2.450 	    0.250 	    2.450  
			    0.000 	    0.450 	    0.000 	    0.450  
]; 
C{1,1}=Mueve(C{1,1}); 
C{2,1}=Mueve(C{1,2}); 
C{3,1}=Mueve(C{1,3}); 
C{4,1}=Mueve(C{1,4}); 
C{5,1}=Mueve(C{1,5}); 
C{6,1}=Mueve(C{1,6}); 
C{7,1}=Mueve(C{1,7}); 
C{2,2}=Mueve(C{2,2}); 
C{3,2}=Mueve(C{2,3}); 
C{4,2}=Mueve(C{2,4}); 
C{5,2}=Mueve(C{2,5}); 
C{6,2}=Mueve(C{2,6}); 
C{7,2}=Mueve(C{2,7}); 
C{3,3}=Mueve(C{3,3}); 
C{4,3}=Mueve(C{3,4}); 
C{5,3}=Mueve(C{3,5}); 
C{6,3}=Mueve(C{3,6}); 
C{7,3}=Mueve(C{3,7}); 
C{4,4}=Mueve(C{4,4}); 
C{5,4}=Mueve(C{4,5}); 
C{6,4}=Mueve(C{4,6}); 
C{7,4}=Mueve(C{4,7}); 
C{5,5}=Mueve(C{5,5}); 
C{6,5}=Mueve(C{5,6}); 
C{7,5}=Mueve(C{5,7}); 
C{6,6}=Mueve(C{6,6}); 
C{7,6}=Mueve(C{6,7}); 
C{7,7}=Mueve(C{7,7}); 
C{8,8}=Mueve(C{8,8}); 
C{9,8}=Mueve(C{8,9}); 
C{9,9}=Mueve(C{9,9}); 
C{10,9}=Mueve(C{9,10}); 
C{11,9}=Mueve(C{9,11}); 
C{12,9}=Mueve(C{9,12}); 
C{13,9}=Mueve(C{9,13}); 
C{10,10}=Mueve(C{10,10}); 
C{11,10}=Mueve(C{10,11}); 
C{12,10}=Mueve(C{10,12}); 
C{13,10}=Mueve(C{10,13}); 
C{11,11}=Mueve(C{11,11}); 
C{12,11}=Mueve(C{11,12}); 
C{13,11}=Mueve(C{11,13}); 
C{12,12}=Mueve(C{12,12}); 
C{13,12}=Mueve(C{12,13}); 
C{13,13}=Mueve(C{13,13}); 
C{14,14}=Mueve(C{14,14}); 
C{15,14}=Mueve(C{14,15}); 
C{17,14}=Mueve(C{14,17}); 
C{15,15}=Mueve(C{15,15}); 
C{17,15}=Mueve(C{15,17}); 
C{16,16}=Mueve(C{16,16}); 
C{17,16}=Mueve(C{16,17}); 
C{17,17}=Mueve(C{17,17}); 
Marcha=zeros(n_t,n_rutas); 
Marcha(1:396,[1,2,3,8,9,14,15])=+1; 
Marcha(397:849,[4,5,6,7,10,11,12,13,16,17])=-1; 
TVr=[3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ;3.500 ]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%  asignacion rutas a trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
R{1}=[3]; 
R{2}=[3]; 
R{3}=[3]; 
R{4}=[3]; 
R{5}=[3]; 
R{6}=[3]; 
R{7}=[3]; 
R{8}=[3]; 
R{9}=[3]; 
R{10}=[3]; 
R{11}=[3]; 
R{12}=[3]; 
R{13}=[3]; 
R{14}=[3]; 
R{15}=[3]; 
R{16}=[3]; 
R{17}=[3]; 
R{18}=[3]; 
R{19}=[3]; 
R{20}=[3]; 
R{21}=[3]; 
R{22}=[3]; 
R{23}=[3]; 
R{24}=[3]; 
R{25}=[3]; 
R{26}=[3]; 
R{27}=[3]; 
R{28}=[3]; 
R{29}=[3]; 
R{30}=[3]; 
R{31}=[3]; 
R{32}=[3]; 
R{33}=[3]; 
R{34}=[3]; 
R{35}=[3]; 
R{36}=[3]; 
R{37}=[3]; 
R{38}=[3]; 
R{39}=[3]; 
R{40}=[3]; 
R{41}=[3]; 
R{42}=[3]; 
R{43}=[3]; 
R{44}=[3]; 
R{45}=[3]; 
R{46}=[3]; 
R{47}=[3]; 
R{48}=[3]; 
R{49}=[3]; 
R{50}=[3]; 
R{51}=[3]; 
R{52}=[3]; 
R{53}=[3]; 
R{54}=[3]; 
R{55}=[3]; 
R{56}=[3]; 
R{57}=[3]; 
R{58}=[3]; 
R{59}=[3]; 
R{60}=[3]; 
R{61}=[3]; 
R{62}=[1,2]; 
R{63}=[1,2]; 
R{64}=[1,2]; 
R{65}=[1,2]; 
R{66}=[1,2]; 
R{67}=[1,2]; 
R{68}=[1,2]; 
R{69}=[1,2]; 
R{70}=[1,2]; 
R{71}=[1,2]; 
R{72}=[1,2]; 
R{73}=[1,2]; 
R{74}=[1,2]; 
R{75}=[1,2]; 
R{76}=[1,2]; 
R{77}=[1,2]; 
R{78}=[1,2]; 
R{79}=[1,2]; 
R{80}=[1,2]; 
R{81}=[1,2]; 
R{82}=[1,2]; 
R{83}=[1,2]; 
R{84}=[1,2]; 
R{85}=[1,2]; 
R{86}=[1,2]; 
R{87}=[1,2]; 
R{88}=[1,2]; 
R{89}=[1,2]; 
R{90}=[1,2]; 
R{91}=[1,2]; 
R{92}=[1,2]; 
R{93}=[1,2]; 
R{94}=[1,2]; 
R{95}=[1,2]; 
R{96}=[1,2]; 
R{97}=[1,2]; 
R{98}=[1,2]; 
R{99}=[1,2]; 
R{100}=[1,2]; 
R{101}=[1,2]; 
R{102}=[1,2]; 
R{103}=[1,2]; 
R{104}=[1,2]; 
R{105}=[1,2]; 
R{106}=[1,2]; 
R{107}=[1,2]; 
R{108}=[1,2]; 
R{109}=[1,2]; 
R{110}=[1,2]; 
R{111}=[1,2]; 
R{112}=[8,9]; 
R{113}=[8,9]; 
R{114}=[8,9]; 
R{115}=[8,9]; 
R{116}=[8,9]; 
R{117}=[8,9]; 
R{118}=[8,9]; 
R{119}=[8,9]; 
R{120}=[8,9]; 
R{121}=[8,9]; 
R{122}=[8,9]; 
R{123}=[8,9]; 
R{124}=[8,9]; 
R{125}=[8,9]; 
R{126}=[8,9]; 
R{127}=[8,9]; 
R{128}=[8,9]; 
R{129}=[8,9]; 
R{130}=[8,9]; 
R{131}=[8,9]; 
R{132}=[8,9]; 
R{133}=[8,9]; 
R{134}=[8,9]; 
R{135}=[8,9]; 
R{136}=[8,9]; 
R{137}=[8,9]; 
R{138}=[8,9]; 
R{139}=[8,9]; 
R{140}=[8,9]; 
R{141}=[8,9]; 
R{142}=[8,9]; 
R{143}=[8,9]; 
R{144}=[8,9]; 
R{145}=[8,9]; 
R{146}=[8,9]; 
R{147}=[8,9]; 
R{148}=[8,9]; 
R{149}=[8,9]; 
R{150}=[8,9]; 
R{151}=[8,9]; 
R{152}=[8,9]; 
R{153}=[8,9]; 
R{154}=[8,9]; 
R{155}=[8,9]; 
R{156}=[8,9]; 
R{157}=[8,9]; 
R{158}=[8,9]; 
R{159}=[8,9]; 
R{160}=[8,9]; 
R{161}=[8,9]; 
R{162}=[8,9]; 
R{163}=[8,9]; 
R{164}=[8,9]; 
R{165}=[8,9]; 
R{166}=[8,9]; 
R{167}=[8,9]; 
R{168}=[8,9]; 
R{169}=[8,9]; 
R{170}=[8,9]; 
R{171}=[8,9]; 
R{172}=[8,9]; 
R{173}=[8,9]; 
R{174}=[8,9]; 
R{175}=[8,9]; 
R{176}=[8,9]; 
R{177}=[8,9]; 
R{178}=[8,9]; 
R{179}=[8,9]; 
R{180}=[8,9]; 
R{181}=[8,9]; 
R{182}=[8,9]; 
R{183}=[8,9]; 
R{184}=[8,9]; 
R{185}=[8,9]; 
R{186}=[8,9]; 
R{187}=[8,9]; 
R{188}=[8,9]; 
R{189}=[8,9]; 
R{190}=[8,9]; 
R{191}=[8,9]; 
R{192}=[8,9]; 
R{193}=[8,9]; 
R{194}=[8,9]; 
R{195}=[8,9]; 
R{196}=[8,9]; 
R{197}=[8,9]; 
R{198}=[8,9]; 
R{199}=[8,9]; 
R{200}=[8,9]; 
R{201}=[8,9]; 
R{202}=[8,9]; 
R{203}=[8,9]; 
R{204}=[8,9]; 
R{205}=[8,9]; 
R{206}=[8,9]; 
R{207}=[8,9]; 
R{208}=[8,9]; 
R{209}=[8,9]; 
R{210}=[8,9]; 
R{211}=[8,9]; 
R{212}=[8,9]; 
R{213}=[8,9]; 
R{214}=[8,9]; 
R{215}=[8,9]; 
R{216}=[8,9]; 
R{217}=[8,9]; 
R{218}=[8,9]; 
R{219}=[8,9]; 
R{220}=[8,9]; 
R{221}=[8,9]; 
R{222}=[8,9]; 
R{223}=[8,9]; 
R{224}=[8,9]; 
R{225}=[8,9]; 
R{226}=[8,9]; 
R{227}=[8,9]; 
R{228}=[8,9]; 
R{229}=[8,9]; 
R{230}=[8,9]; 
R{231}=[8,9]; 
R{232}=[8,9]; 
R{233}=[8,9]; 
R{234}=[8,9]; 
R{235}=[8,9]; 
R{236}=[8,9]; 
R{237}=[8,9]; 
R{238}=[8,9]; 
R{239}=[8,9]; 
R{240}=[8,9]; 
R{241}=[8,9]; 
R{242}=[8,9]; 
R{243}=[8,9]; 
R{244}=[8,9]; 
R{245}=[8,9]; 
R{246}=[8,9]; 
R{247}=[8,9]; 
R{248}=[14,15]; 
R{249}=[14,15]; 
R{250}=[14,15]; 
R{251}=[14,15]; 
R{252}=[14,15]; 
R{253}=[14,15]; 
R{254}=[14,15]; 
R{255}=[14,15]; 
R{256}=[14,15]; 
R{257}=[14,15]; 
R{258}=[14,15]; 
R{259}=[14,15]; 
R{260}=[14,15]; 
R{261}=[14,15]; 
R{262}=[14,15]; 
R{263}=[14,15]; 
R{264}=[14,15]; 
R{265}=[14,15]; 
R{266}=[14,15]; 
R{267}=[14,15]; 
R{268}=[14,15]; 
R{269}=[14,15]; 
R{270}=[14,15]; 
R{271}=[14,15]; 
R{272}=[14,15]; 
R{273}=[14,15]; 
R{274}=[14,15]; 
R{275}=[14,15]; 
R{276}=[14,15]; 
R{277}=[14,15]; 
R{278}=[14,15]; 
R{279}=[14,15]; 
R{280}=[14,15]; 
R{281}=[14,15]; 
R{282}=[14,15]; 
R{283}=[14,15]; 
R{284}=[14,15]; 
R{285}=[14,15]; 
R{286}=[14,15]; 
R{287}=[14,15]; 
R{288}=[14,15]; 
R{289}=[14,15]; 
R{290}=[14,15]; 
R{291}=[14,15]; 
R{292}=[14,15]; 
R{293}=[14,15]; 
R{294}=[14,15]; 
R{295}=[14,15]; 
R{296}=[14,15]; 
R{297}=[14,15]; 
R{298}=[14,15]; 
R{299}=[14,15]; 
R{300}=[14,15]; 
R{301}=[14,15]; 
R{302}=[14,15]; 
R{303}=[14,15]; 
R{304}=[14,15]; 
R{305}=[14,15]; 
R{306}=[14,15]; 
R{307}=[14,15]; 
R{308}=[14,15]; 
R{309}=[14,15]; 
R{310}=[14,15]; 
R{311}=[14,15]; 
R{312}=[14,15]; 
R{313}=[14,15]; 
R{314}=[14,15]; 
R{315}=[14,15]; 
R{316}=[14,15]; 
R{317}=[14,15]; 
R{318}=[14,15]; 
R{319}=[14,15]; 
R{320}=[14,15]; 
R{321}=[14,15]; 
R{322}=[14,15]; 
R{323}=[14,15]; 
R{324}=[14,15]; 
R{325}=[14,15]; 
R{326}=[14,15]; 
R{327}=[14,15]; 
R{328}=[14,15]; 
R{329}=[14,15]; 
R{330}=[14,15]; 
R{331}=[14,15]; 
R{332}=[14,15]; 
R{333}=[14,15]; 
R{334}=[14,15]; 
R{335}=[14,15]; 
R{336}=[14,15]; 
R{337}=[14,15]; 
R{338}=[14,15]; 
R{339}=[14,15]; 
R{340}=[14,15]; 
R{341}=[14,15]; 
R{342}=[14,15]; 
R{343}=[14,15]; 
R{344}=[14,15]; 
R{345}=[14,15]; 
R{346}=[14,15]; 
R{347}=[14,15]; 
R{348}=[14,15]; 
R{349}=[14,15]; 
R{350}=[14,15]; 
R{351}=[14,15]; 
R{352}=[14,15]; 
R{353}=[14,15]; 
R{354}=[14,15]; 
R{355}=[14,15]; 
R{356}=[14,15]; 
R{357}=[14,15]; 
R{358}=[14,15]; 
R{359}=[14,15]; 
R{360}=[14,15]; 
R{361}=[14,15]; 
R{362}=[14,15]; 
R{363}=[14,15]; 
R{364}=[14,15]; 
R{365}=[14,15]; 
R{366}=[14,15]; 
R{367}=[14,15]; 
R{368}=[14,15]; 
R{369}=[14,15]; 
R{370}=[14,15]; 
R{371}=[14,15]; 
R{372}=[14,15]; 
R{373}=[14,15]; 
R{374}=[14,15]; 
R{375}=[14,15]; 
R{376}=[14,15]; 
R{377}=[14,15]; 
R{378}=[14,15]; 
R{379}=[14,15]; 
R{380}=[14,15]; 
R{381}=[14,15]; 
R{382}=[14,15]; 
R{383}=[14,15]; 
R{384}=[14,15]; 
R{385}=[14,15]; 
R{386}=[14,15]; 
R{387}=[14,15]; 
R{388}=[14,15]; 
R{389}=[14,15]; 
R{390}=[14,15]; 
R{391}=[14,15]; 
R{392}=[14,15]; 
R{393}=[14,15]; 
R{394}=[14,15]; 
R{395}=[14,15]; 
R{396}=[14,15]; 
R{397}=[6,7]; 
R{398}=[6,7]; 
R{399}=[6,7]; 
R{400}=[6,7]; 
R{401}=[6,7]; 
R{402}=[6,7]; 
R{403}=[6,7]; 
R{404}=[6,7]; 
R{405}=[6,7]; 
R{406}=[6,7]; 
R{407}=[6,7]; 
R{408}=[6,7]; 
R{409}=[6,7]; 
R{410}=[6,7]; 
R{411}=[6,7]; 
R{412}=[6,7]; 
R{413}=[6,7]; 
R{414}=[6,7]; 
R{415}=[6,7]; 
R{416}=[6,7]; 
R{417}=[6,7]; 
R{418}=[6,7]; 
R{419}=[6,7]; 
R{420}=[6,7]; 
R{421}=[6,7]; 
R{422}=[6,7]; 
R{423}=[6,7]; 
R{424}=[6,7]; 
R{425}=[6,7]; 
R{426}=[6,7]; 
R{427}=[6,7]; 
R{428}=[6,7]; 
R{429}=[6,7]; 
R{430}=[6,7]; 
R{431}=[6,7]; 
R{432}=[6,7]; 
R{433}=[6,7]; 
R{434}=[6,7]; 
R{435}=[6,7]; 
R{436}=[6,7]; 
R{437}=[6,7]; 
R{438}=[6,7]; 
R{439}=[6,7]; 
R{440}=[6,7]; 
R{441}=[6,7]; 
R{442}=[6,7]; 
R{443}=[6,7]; 
R{444}=[6,7]; 
R{445}=[6,7]; 
R{446}=[6,7]; 
R{447}=[6,7]; 
R{448}=[6,7]; 
R{449}=[6,7]; 
R{450}=[6,7]; 
R{451}=[6,7]; 
R{452}=[6,7]; 
R{453}=[6,7]; 
R{454}=[6,7]; 
R{455}=[6,7]; 
R{456}=[6,7]; 
R{457}=[6,7]; 
R{458}=[6,7]; 
R{459}=[6,7]; 
R{460}=[4,5]; 
R{461}=[4,5]; 
R{462}=[4,5]; 
R{463}=[4,5]; 
R{464}=[4,5]; 
R{465}=[4,5]; 
R{466}=[4,5]; 
R{467}=[4,5]; 
R{468}=[4,5]; 
R{469}=[4,5]; 
R{470}=[4,5]; 
R{471}=[4,5]; 
R{472}=[4,5]; 
R{473}=[4,5]; 
R{474}=[4,5]; 
R{475}=[4,5]; 
R{476}=[4,5]; 
R{477}=[4,5]; 
R{478}=[4,5]; 
R{479}=[4,5]; 
R{480}=[4,5]; 
R{481}=[4,5]; 
R{482}=[4,5]; 
R{483}=[4,5]; 
R{484}=[4,5]; 
R{485}=[4,5]; 
R{486}=[4,5]; 
R{487}=[4,5]; 
R{488}=[4,5]; 
R{489}=[4,5]; 
R{490}=[4,5]; 
R{491}=[4,5]; 
R{492}=[4,5]; 
R{493}=[4,5]; 
R{494}=[4,5]; 
R{495}=[4,5]; 
R{496}=[4,5]; 
R{497}=[4,5]; 
R{498}=[4,5]; 
R{499}=[4,5]; 
R{500}=[4,5]; 
R{501}=[4,5]; 
R{502}=[4,5]; 
R{503}=[4,5]; 
R{504}=[4,5]; 
R{505}=[4,5]; 
R{506}=[4,5]; 
R{507}=[4,5]; 
R{508}=[4,5]; 
R{509}=[10,11]; 
R{510}=[10,11]; 
R{511}=[10,11]; 
R{512}=[10,11]; 
R{513}=[10,11]; 
R{514}=[10,11]; 
R{515}=[10,11]; 
R{516}=[10,11]; 
R{517}=[10,11]; 
R{518}=[10,11]; 
R{519}=[10,11]; 
R{520}=[10,11]; 
R{521}=[10,11]; 
R{522}=[10,11]; 
R{523}=[10,11]; 
R{524}=[10,11]; 
R{525}=[10,11]; 
R{526}=[10,11]; 
R{527}=[10,11]; 
R{528}=[10,11]; 
R{529}=[10,11]; 
R{530}=[10,11]; 
R{531}=[10,11]; 
R{532}=[10,11]; 
R{533}=[10,11]; 
R{534}=[10,11]; 
R{535}=[10,11]; 
R{536}=[10,11]; 
R{537}=[10,11]; 
R{538}=[10,11]; 
R{539}=[10,11]; 
R{540}=[10,11]; 
R{541}=[10,11]; 
R{542}=[10,11]; 
R{543}=[10,11]; 
R{544}=[10,11]; 
R{545}=[10,11]; 
R{546}=[10,11]; 
R{547}=[10,11]; 
R{548}=[10,11]; 
R{549}=[10,11]; 
R{550}=[10,11]; 
R{551}=[10,11]; 
R{552}=[10,11]; 
R{553}=[10,11]; 
R{554}=[10,11]; 
R{555}=[10,11]; 
R{556}=[10,11]; 
R{557}=[10,11]; 
R{558}=[10,11]; 
R{559}=[10,11]; 
R{560}=[10,11]; 
R{561}=[10,11]; 
R{562}=[10,11]; 
R{563}=[10,11]; 
R{564}=[10,11]; 
R{565}=[10,11]; 
R{566}=[12,13]; 
R{567}=[12,13]; 
R{568}=[12,13]; 
R{569}=[12,13]; 
R{570}=[12,13]; 
R{571}=[12,13]; 
R{572}=[12,13]; 
R{573}=[12,13]; 
R{574}=[12,13]; 
R{575}=[12,13]; 
R{576}=[12,13]; 
R{577}=[12,13]; 
R{578}=[12,13]; 
R{579}=[12,13]; 
R{580}=[12,13]; 
R{581}=[12,13]; 
R{582}=[12,13]; 
R{583}=[12,13]; 
R{584}=[12,13]; 
R{585}=[12,13]; 
R{586}=[12,13]; 
R{587}=[12,13]; 
R{588}=[12,13]; 
R{589}=[12,13]; 
R{590}=[12,13]; 
R{591}=[12,13]; 
R{592}=[12,13]; 
R{593}=[12,13]; 
R{594}=[12,13]; 
R{595}=[12,13]; 
R{596}=[12,13]; 
R{597}=[12,13]; 
R{598}=[12,13]; 
R{599}=[12,13]; 
R{600}=[12,13]; 
R{601}=[12,13]; 
R{602}=[12,13]; 
R{603}=[12,13]; 
R{604}=[12,13]; 
R{605}=[12,13]; 
R{606}=[12,13]; 
R{607}=[12,13]; 
R{608}=[12,13]; 
R{609}=[12,13]; 
R{610}=[12,13]; 
R{611}=[12,13]; 
R{612}=[12,13]; 
R{613}=[12,13]; 
R{614}=[12,13]; 
R{615}=[12,13]; 
R{616}=[12,13]; 
R{617}=[12,13]; 
R{618}=[12,13]; 
R{619}=[12,13]; 
R{620}=[12,13]; 
R{621}=[12,13]; 
R{622}=[12,13]; 
R{623}=[12,13]; 
R{624}=[12,13]; 
R{625}=[12,13]; 
R{626}=[12,13]; 
R{627}=[12,13]; 
R{628}=[12,13]; 
R{629}=[12,13]; 
R{630}=[12,13]; 
R{631}=[12,13]; 
R{632}=[12,13]; 
R{633}=[12,13]; 
R{634}=[12,13]; 
R{635}=[12,13]; 
R{636}=[12,13]; 
R{637}=[12,13]; 
R{638}=[12,13]; 
R{639}=[12,13]; 
R{640}=[12,13]; 
R{641}=[12,13]; 
R{642}=[12,13]; 
R{643}=[12,13]; 
R{644}=[12,13]; 
R{645}=[12,13]; 
R{646}=[12,13]; 
R{647}=[12,13]; 
R{648}=[12,13]; 
R{649}=[12,13]; 
R{650}=[12,13]; 
R{651}=[12,13]; 
R{652}=[12,13]; 
R{653}=[12,13]; 
R{654}=[12,13]; 
R{655}=[12,13]; 
R{656}=[12,13]; 
R{657}=[12,13]; 
R{658}=[12,13]; 
R{659}=[12,13]; 
R{660}=[12,13]; 
R{661}=[12,13]; 
R{662}=[12,13]; 
R{663}=[12,13]; 
R{664}=[12,13]; 
R{665}=[12,13]; 
R{666}=[12,13]; 
R{667}=[12,13]; 
R{668}=[12,13]; 
R{669}=[12,13]; 
R{670}=[12,13]; 
R{671}=[12,13]; 
R{672}=[12,13]; 
R{673}=[12,13]; 
R{674}=[12,13]; 
R{675}=[12,13]; 
R{676}=[12,13]; 
R{677}=[12,13]; 
R{678}=[12,13]; 
R{679}=[12,13]; 
R{680}=[12,13]; 
R{681}=[12,13]; 
R{682}=[12,13]; 
R{683}=[12,13]; 
R{684}=[12,13]; 
R{685}=[12,13]; 
R{686}=[12,13]; 
R{687}=[12,13]; 
R{688}=[12,13]; 
R{689}=[12,13]; 
R{690}=[12,13]; 
R{691}=[12,13]; 
R{692}=[12,13]; 
R{693}=[12,13]; 
R{694}=[12,13]; 
R{695}=[12,13]; 
R{696}=[12,13]; 
R{697}=[12,13]; 
R{698}=[12,13]; 
R{699}=[12,13]; 
R{700}=[16,17]; 
R{701}=[16,17]; 
R{702}=[16,17]; 
R{703}=[16,17]; 
R{704}=[16,17]; 
R{705}=[16,17]; 
R{706}=[16,17]; 
R{707}=[16,17]; 
R{708}=[16,17]; 
R{709}=[16,17]; 
R{710}=[16,17]; 
R{711}=[16,17]; 
R{712}=[16,17]; 
R{713}=[16,17]; 
R{714}=[16,17]; 
R{715}=[16,17]; 
R{716}=[16,17]; 
R{717}=[16,17]; 
R{718}=[16,17]; 
R{719}=[16,17]; 
R{720}=[16,17]; 
R{721}=[16,17]; 
R{722}=[16,17]; 
R{723}=[16,17]; 
R{724}=[16,17]; 
R{725}=[16,17]; 
R{726}=[16,17]; 
R{727}=[16,17]; 
R{728}=[16,17]; 
R{729}=[16,17]; 
R{730}=[16,17]; 
R{731}=[16,17]; 
R{732}=[16,17]; 
R{733}=[16,17]; 
R{734}=[16,17]; 
R{735}=[16,17]; 
R{736}=[16,17]; 
R{737}=[16,17]; 
R{738}=[16,17]; 
R{739}=[16,17]; 
R{740}=[16,17]; 
R{741}=[16,17]; 
R{742}=[16,17]; 
R{743}=[16,17]; 
R{744}=[16,17]; 
R{745}=[16,17]; 
R{746}=[16,17]; 
R{747}=[16,17]; 
R{748}=[16,17]; 
R{749}=[16,17]; 
R{750}=[16,17]; 
R{751}=[16,17]; 
R{752}=[16,17]; 
R{753}=[16,17]; 
R{754}=[16,17]; 
R{755}=[16,17]; 
R{756}=[16,17]; 
R{757}=[16,17]; 
R{758}=[16,17]; 
R{759}=[16,17]; 
R{760}=[16,17]; 
R{761}=[16,17]; 
R{762}=[16,17]; 
R{763}=[16,17]; 
R{764}=[16,17]; 
R{765}=[16,17]; 
R{766}=[16,17]; 
R{767}=[16,17]; 
R{768}=[16,17]; 
R{769}=[16,17]; 
R{770}=[16,17]; 
R{771}=[16,17]; 
R{772}=[16,17]; 
R{773}=[16,17]; 
R{774}=[16,17]; 
R{775}=[16,17]; 
R{776}=[16,17]; 
R{777}=[16,17]; 
R{778}=[16,17]; 
R{779}=[16,17]; 
R{780}=[16,17]; 
R{781}=[16,17]; 
R{782}=[16,17]; 
R{783}=[16,17]; 
R{784}=[16,17]; 
R{785}=[16,17]; 
R{786}=[16,17]; 
R{787}=[16,17]; 
R{788}=[16,17]; 
R{789}=[16,17]; 
R{790}=[16,17]; 
R{791}=[16,17]; 
R{792}=[16,17]; 
R{793}=[16,17]; 
R{794}=[16,17]; 
R{795}=[16,17]; 
R{796}=[16,17]; 
R{797}=[16,17]; 
R{798}=[16,17]; 
R{799}=[16,17]; 
R{800}=[16,17]; 
R{801}=[16,17]; 
R{802}=[16,17]; 
R{803}=[16,17]; 
R{804}=[16,17]; 
R{805}=[16,17]; 
R{806}=[16,17]; 
R{807}=[16,17]; 
R{808}=[16,17]; 
R{809}=[16,17]; 
R{810}=[16,17]; 
R{811}=[16,17]; 
R{812}=[16,17]; 
R{813}=[16,17]; 
R{814}=[16,17]; 
R{815}=[16,17]; 
R{816}=[16,17]; 
R{817}=[16,17]; 
R{818}=[16,17]; 
R{819}=[16,17]; 
R{820}=[16,17]; 
R{821}=[16,17]; 
R{822}=[16,17]; 
R{823}=[16,17]; 
R{824}=[16,17]; 
R{825}=[16,17]; 
R{826}=[16,17]; 
R{827}=[16,17]; 
R{828}=[16,17]; 
R{829}=[16,17]; 
R{830}=[16,17]; 
R{831}=[16,17]; 
R{832}=[16,17]; 
R{833}=[16,17]; 
R{834}=[16,17]; 
R{835}=[16,17]; 
R{836}=[16,17]; 
R{837}=[16,17]; 
R{838}=[16,17]; 
R{839}=[16,17]; 
R{840}=[16,17]; 
R{841}=[16,17]; 
R{842}=[16,17]; 
R{843}=[16,17]; 
R{844}=[16,17]; 
R{845}=[16,17]; 
R{846}=[16,17]; 
R{847}=[16,17]; 
R{848}=[16,17]; 
R{849}=[16,17]; 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%% ordenacion procesamiento de trenes            %%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
[t_pla,I]=InitOrden(initia,t_pla,n_t); % inicializacion del orden del procesamiento
at=at(I); 
vt=vt.^(-1); 
vt=vt(I); 
Ntipotren=Ntipotren(I); 
Raux=R; 
Marcha=Marcha(I,:); 
for i=1:n_t 
   R{i}=Raux{I(i)}; 
end 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 %%%                 tiempo de viaje trenes 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 for t1=1:n_t 
     for i_r=1:length(R{t1}) 
         D_t(t1,i_r)=TVr(R{t1}(i_r))*vt(t1)-at(t1); 
     end 
 end 
 n_s=0; % numero máximo de conflicto entre un par de trenes 
for t1=1:n_t-1 
    for t2=t1+1:n_t 
        for i_r1=1:length(R{t1}) 
            r1=R{t1}(i_r1); 
            for i_r2=1:length(R{t2}) 
                r2=R{t2}(i_r2); 
                if length(C{r1,r2})>0 
                C_t{i_r1,i_r2,t1,t2}=[C{r1,r2}(:,1:2)*vt(t1) C{r1,r2}(:,3:4)*vt(t2)]; 
                C_t{i_r2,i_r1,t2,t1}=[C{r2,r1}(:,1:2)*vt(t2) C{r2,r1}(:,3:4)*vt(t1)]; 
                n_s=max(n_s,size(C_t{i_r1,i_r2,t1,t2},1)); 
                end 
            end 
        end 
    end 
end 
%%%%%%%%%%% FIN PROBLEMA4c
%%%%%%%%%%%%%%%%%%%%%%%%%%%% fin de escritura de problemas
    otherwise
        warning('NOMBRE DEL PROBLEMA INESPERADO. NO SE HA CREADO EL PROBLEMA ');
end

clear initia %ñapa
file_dat=[file_directory file_name '_' version '_' id '.MAT']
save(file_dat)
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% InitOrden  inicializa el orden del procesamiento de trenes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [t_pla,I]=InitOrden(initia,t_pla,n_t)

if strcmp(initia,'orden')
    [t_pla,I]=sort(t_pla); % ordenacion de procesamiento de trenes
elseif strcmp(initia,'aleatoria')
    I=randperm(n_t);
    t_pla=t_pla(I);
end

end